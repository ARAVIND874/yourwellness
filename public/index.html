<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ஆரோக்கிய நண்பன் - உங்கள் ஆரோக்கிய வழிகாட்டி</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #E6F7FF; /* Light Blue */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1.5rem;
            color: #333333;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            box-sizing: border-box;
            transition: all 0.5s ease-in-out;
            overflow-y: auto; /* Allow scrolling for features */
        }

        .container {
            max-width: 640px;
            width: 100%;
            background-color: #ffffff;
            border-radius: 1.75rem;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
            padding: 2.5rem;
            text-align: center;
            position: relative;
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .language-selector-wrapper {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
        }
        .input-wrapper {
            position: relative;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }
        .input-field {
            flex-grow: 1;
            padding: 1rem 1.25rem;
            padding-right: 3.5rem; /* Space for mic icon */
            border: 1px solid #D1D5DB;
            border-radius: 0.875rem;
            font-size: 1.05rem;
            box-sizing: border-box;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .input-field:focus {
            border-color: #87CEEB;
            box-shadow: 0 0 0 3px rgba(135, 206, 235, 0.4);
        }
        .mic-button {
            position: absolute;
            right: 1rem;
            background: none;
            border: none;
            color: #0000FF;
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: color 0.3s ease, background-color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .mic-button:hover {
            color: #DC2626; /* Red */
            background-color: rgba(220, 38, 38, 0.1);
        }
        .mic-button.recording {
            color: #DC2626; /* Red */
            animation: pulse 1s infinite alternate;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.1); opacity: 0.7; }
        }

        .generate-button, .action-button, .ai-voice-button, .back-to-main-button {
            background-color: #6A0DAD; /* Dark Violet */
            color: #ffffff;
            padding: 1rem 2rem;
            border-radius: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 15px rgba(106, 13, 173, 0.4);
            letter-spacing: 0.025em;
            margin-top: 1rem;
            border: none;
            display: inline-flex; /* Ensure flex behavior for centering icon/text */
            align-items: center;
            justify-content: center;
            gap: 0.5rem; /* Space between icon and text */
        }
        .generate-button:hover, .action-button:hover, .ai-voice-button:hover, .back-to-main-button:hover {
            background-color: #4B0A7B; /* Darker Violet */
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(106, 13, 173, 0.5);
        }
        .generate-button:active, .action-button:active, .ai-voice-button:active, .back-to-main-button:active {
            transform: translateY(0);
            box-shadow: 0 4px 10px rgba(106, 13, 173, 0.3);
        }
        .loading-indicator {
            display: none;
            margin-top: 2rem;
            font-size: 1.15rem;
            color: #6B7280;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6A0DAD;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .tip-box, .result-box { /* Unified style for all output boxes */
            background-color: #FFFFAA; /* Light Yellow */
            border: 1px solid #CCCC88; /* Darker Yellow */
            border-radius: 1.25rem;
            padding: 2rem;
            margin-top: 2rem;
            text-align: left;
            color: #333333;
            line-height: 1.7;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: italic;
            font-size: 1.05rem;
            transition: all 0.5s ease-in-out;
            word-break: break-word; /* Ensure long words break */
        }
        .tip-box p, .result-box p {
            margin: 0;
        }
        .text-red-600 {
            color: #DC2626; /* Red */
        }
        /* Responsive adjustments */
        @media (max-width: 640px) {
            body {
                padding: 1rem;
            }
            .container {
                padding: 1.5rem;
                border-radius: 1.25rem;
            }
            .generate-button, .action-button, .ai-voice-button, .back-to-main-button {
                width: 100%;
                padding: 0.9rem 1.5rem;
            }
            .language-selector-wrapper {
                top: 0.75rem;
                right: 0.75rem;
            }
            .input-wrapper {
                flex-direction: row;
                justify-content: center;
            }
            .mic-button {
                position: absolute;
                right: 0.5rem;
            }
        }
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #E6F7FF;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 1s ease-out;
            overflow: hidden;
        }
        .splash-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        .splash-screen img {
            max-width: 25%;
            max-height: 25%;
            object-fit: contain;
        }

        /* Feature Button for Main Page */
        .features-toggle-button {
            font-size: 4rem; /* Even larger emoji size for the main toggle */
            cursor: pointer;
            padding: 1rem;
            border-radius: 1rem;
            transition: transform 0.3s ease, background-color 0.3s ease;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            line-height: 1;
            margin-top: 2rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            background-color: #e0f2fe; /* Light blue background */
        }
        .features-toggle-button:hover {
            transform: scale(1.05);
            background-color: #bee3f8; /* Slightly darker blue hover */
        }
        .features-toggle-button span.label {
            font-size: 1rem;
            margin-top: 0.75rem;
            color: #333;
            font-weight: 600;
        }

        /* Feature Icons and Sections */
        .feature-icon-container {
            display: flex;
            justify-content: center;
            gap: 1.5rem; /* Space between icons */
            margin-top: 2rem;
            flex-wrap: wrap; /* Allow icons to wrap on smaller screens */
        }
        .feature-icon {
            font-size: 3rem; /* Larger emoji size */
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.75rem;
            transition: transform 0.2s ease, background-color 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            line-height: 1;
        }
        .feature-icon:hover {
            transform: translateY(-5px);
            background-color: rgba(135, 206, 235, 0.1); /* Light blue hover */
        }
        .feature-icon span.label {
            font-size: 0.8rem; /* Smaller text label */
            margin-top: 0.5rem;
            color: #555;
            font-weight: 500;
        }

        /* Feature sections (initially hidden, shown by JS) */
        .feature-section {
            display: none;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e5e7eb; /* Subtle separator */
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Specific feature section styles */
        .dropdown-menu {
            position: absolute;
            background-color: white;
            border: 1px solid #D1D5DB;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            text-align: left;
            padding: 0.5rem 0;
            top: calc(100% + 5px); /* Position below input */
            left: 0;
        }
        .dropdown-menu div {
            padding: 0.75rem 1.25rem;
            cursor: pointer;
        }
        .dropdown-menu div:hover {
            background-color: #F3F4F6;
        }
        .dropdown-menu div.selected {
            background-color: #e0f2fe; /* light blue */
            font-weight: 500;
        }
        
        .tts-voice-selector {
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.875rem;
            font-size: 0.95rem;
            background-color: white;
            margin-left: 1rem;
            flex-grow: 1;
        }
        .body-map-container {
            position: relative;
            width: 100%;
            max-width: 300px; /* Adjust as needed */
            margin: 0 auto;
            border: 1px solid #ccc;
            border-radius: 10px;
            overflow: hidden;
        }
        .body-map-image {
            width: 100%;
            height: auto;
            display: block;
        }
        .pain-dot {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: red;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
            transform: translate(-50%, -50%); /* Center the dot on the click */
        }
        .pain-dot.selected {
            background-color: darkred;
            border: 2px solid yellow;
        }
        /* Hide all feature sections by default */
        .feature-section {
            display: none;
        }
        /* Show the main view or a specific section */
        #initialView, #allFeatureIconsContainer.active, .feature-section.active {
            display: block;
        }
        .back-button {
            background: none;
            border: none;
            color: #6A0DAD;
            font-weight: 600;
            cursor: pointer;
            padding: 0.5rem 0;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1rem;
            transition: color 0.3s ease;
        }
        .back-button:hover {
            color: #4B0A7B;
        }
    </style>
</head>
<body>
    <div id="splashScreen" class="splash-screen">
        <img src="https://via.placeholder.com/150/E6F7FF/000000?text=Healthcare+Logo" alt="Healthcare related image">
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <div class="language-selector-wrapper">
            <select id="languageSelect" aria-label="Select Language" class="p-2 border border-gray-300 rounded-md text-sm bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300">
                <option value="ta">தமிழ்</option>
                <option value="en">English</option>
            </select>
        </div>

        <div id="initialView">
            <h1 id="mainTitle" class="text-3xl font-bold text-gray-800 mb-4 lg:text-4xl"></h1>
            <p id="descriptionText" class="text-gray-600 mb-8 text-lg"></p>

            <h2 id="tipSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4"></h2>
            <div class="input-wrapper">
                <input type="text" id="goalInput" class="input-field" aria-label="உங்கள் ஆரோக்கிய இலக்கை உள்ளிடவும்">
                <button id="micBtn" class="mic-button" title="உங்கள் இலக்கைப் பேசுங்கள்" aria-label="உங்கள் ஆரோக்கிய இலக்கைப் பதிவு செய்யவும்">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="23"></line>
                        <line x1="8" y1="23" x2="16" y2="23"></line>
                    </svg>
                </button>
            </div>
            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <button id="generateBtn" class="generate-button"></button>
                <button id="aiVoiceBtn" class="ai-voice-button" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-2">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                        <path d="M19.07 4.93a10 10 0 0 1 0 14.14M23.31 1.69a16 16 0 0 1 0 20.62"></path>
                    </svg>
                </button>
                <select id="ttsVoiceSelect" class="tts-voice-selector" style="display: none;" aria-label="Select Voice"></select>
            </div>
            <div id="loading" class="loading-indicator" aria-live="polite">
                <div class="loading-spinner"></div>
                <p id="loadingText"></p>
            </div>
            <div id="tipOutput" class="tip-box" aria-live="polite"></div>

            <hr class="border-t border-gray-300 my-8">

            <h2 id="featuresTitle" class="text-2xl font-semibold text-gray-700 mb-4"></h2>
            <button id="toggleFeaturesBtn" class="features-toggle-button" title="அனைத்து அம்சங்களையும் காண்க">
                ✨<span class="label" data-label-key="showFeaturesLabel"></span>
            </button>
        </div>

        <div id="featuresListView" style="display: none;">
            <button class="back-to-main-button" id="backToMainFromFeaturesList">← பின்செல்</button>
            <h1 id="featuresPageTitle" class="text-3xl font-bold text-gray-800 mb-6 mt-4 lg:text-4xl"></h1>
            <div id="allFeatureIconsContainer" class="feature-icon-container">
                <div id="iconStepTracker" class="feature-icon" data-section="stepTrackerSection" title="படி டிராக்கர்">👟<span class="label" data-label-key="stepTrackerLabel"></span></div>
                <div id="iconHeartRateTracker" class="feature-icon" data-section="heartRateTrackerSection" title="இதயத் துடிப்பு டிராக்கர்">💓<span class="label" data-label-key="heartRateTrackerLabel"></span></div>
                <div id="iconWaterTracker" class="feature-icon" data-section="waterTrackerSection" title="தண்ணீர் டிராக்கர்">💧<span class="label" data-label-key="waterTrackerLabel"></span></div>
                <div id="iconJournal" class="feature-icon" data-section="journalSection" title="மனநிலை & நன்றியுணர்வு ஜர்னல்">📝<span class="label" data-label-key="journalLabel"></span></div>
                <div id="iconLocalTips" class="feature-icon" data-section="localTipsSection" title="உள்ளூர் ஆரோக்கிய குறிப்புகள்">🌱<span class="label" data-label-key="localTipsLabel"></span></div>
                <div id="iconMealPlan" class="feature-icon" data-section="mealPlanSection" title="உணவுத் திட்டப் பரிந்துரைகள்">🍽️<span class="label" data-label-key="mealPlanLabel"></span></div>
                <div id="iconMoodAnalysis" class="feature-icon" data-section="moodAnalysisSection" title="உணர்வுப் பதிவேடு பகுப்பாய்வு">🧠<span class="label" data-label-key="moodAnalysisLabel"></span></div>
                <div id="iconExerciseYoga" class="feature-icon" data-section="exerciseYogaSection" title="உடற்பயிற்சி & யோகா">🤸‍♀️<span class="label" data-label-key="exerciseYogaLabel"></span></div>
                <div id="iconDiseasePrevention" class="feature-icon" data-section="diseasePreventionSection" title="நோய் தடுப்பு">🛡️<span class="label" data-label-key="diseasePreventionLabel"></span></div>
                <div id="iconWellnessChallenge" class="feature-icon" data-section="wellnessChallengeSection" title="ஆரோக்கிய சவால்கள்">🏅<span class="label" data-label-key="wellnessChallengeLabel"></span></div>
                <div id="iconMedicationReminder" class="feature-icon" data-section="medicationReminderSection" title="மருந்து நினைவூட்டல்">⏰<span class="label" data-label-key="medicationReminderLabel"></span></div>
                <div id="iconBodyPainMapping" class="feature-icon" data-section="bodyPainMappingSection" title="உடல் வலி மேப்பிங்">📍<span class="label" data-label-key="bodyPainMappingLabel"></span></div>
                <div id="iconFirstAidEmergency" class="feature-icon" data-section="firstAidEmergencySection" title="முதலுதவி & அவசர உதவி">🆘<span class="label" data-label-key="firstAidEmergencyLabel"></span></div>
            </div>
        </div>

        <div id="stepTrackerSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="stepSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <div class="input-wrapper">
                <label for="currentStepsDisplay" class="sr-only">தற்போதைய படிகள்</label>
                <input type="text" id="currentStepsDisplay" class="input-field" value="0" readonly aria-atomic="true">
            </div>
            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <button id="addOneStepBtn" class="action-button"></button>
                <button id="toggleTrackingBtn" class="action-button"></button>
                <button id="resetStepsBtn" class="action-button"></button>
            </div>
            <div id="stepResultOutput" class="result-box" aria-live="polite"></div>
        </div>

        <div id="heartRateTrackerSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="heartRateSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <div class="input-wrapper">
                <label for="currentHeartRateDisplay" class="sr-only">தற்போதைய இதயத் துடிப்பு</label>
                <input type="text" id="currentHeartRateDisplay" class="input-field" value="0" readonly aria-atomic="true">
            </div>
            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <button id="simulateHeartRateBtn" class="action-button"></button>
                <button id="resetHeartRateBtn" class="action-button"></button>
            </div>
            <div id="heartRateResultOutput" class="result-box" aria-live="polite"></div>
        </div>

        <div id="waterTrackerSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="waterSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <div class="input-wrapper">
                <label for="waterIntakeDisplay" class="sr-only">தற்போதைய தண்ணீர் உட்கொள்ளல்</label>
                <input type="text" id="waterIntakeDisplay" class="input-field" value="0 ml" readonly aria-atomic="true">
            </div>
            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <button id="addWaterBtn" class="action-button"></button>
                <button id="resetWaterBtn" class="action-button"></button>
            </div>
            <div id="waterResultOutput" class="result-box" aria-live="polite"></div>
        </div>

        <div id="journalSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="journalSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="journalDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper flex-col items-stretch">
                <label for="moodSelect" class="sr-only">உங்கள் மனநிலையைத் தேர்ந்தெடுக்கவும்</label>
                <select id="moodSelect" class="input-field mb-4" aria-label="உங்கள் மனநிலையைத் தேர்ந்தெடுக்கவும்">
                    <option value="">உங்கள் மனநிலையைத் தேர்ந்தெடுக்கவும்</option>
                    <option value="happy">மகிழ்ச்சி 😄</option>
                    <option value="neutral">சாதாரணம் 😐</option>
                    <option value="sad">சோகம் 😔</option>
                    <option value="stressed">மன அழுத்தம் 😩</option>
                    <option value="energetic">ஆற்றல் 💪</option>
                </select>
                <label for="gratitudeInput" class="sr-only">நீங்கள் நன்றியுள்ள ஒரு விஷயத்தை எழுதுங்கள்</label>
                <textarea id="gratitudeInput" class="input-field min-h-[100px]" placeholder="நீங்கள் நன்றியுள்ள ஒரு விஷயத்தை எழுதுங்கள்..." aria-label="நீங்கள் நன்றியுள்ள ஒரு விஷயத்தை எழுதுங்கள்"></textarea>
            </div>
            <button id="saveJournalEntryBtn" class="action-button mt-4"></button>
            <div id="journalEntriesOutput" class="result-box mt-4 text-left"></div>
        </div>

        <div id="localTipsSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="localTipsSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="localTipsDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper mb-4">
                <input type="text" id="localTipCategory" class="input-field" aria-label="உதவிக்குறிப்பு வகையை உள்ளிடவும்" placeholder="எ.கா. மஞ்சள், முருங்கை, தியானம்...">
                <div id="localTipCategoryDropdown" class="dropdown-menu hidden mt-2 top-full left-0"></div>
            </div>
            <button id="getLocalTipBtn" class="generate-button"></button>
            <div id="localTipOutput" class="tip-box" aria-live="polite"></div>
        </div>

        <div id="mealPlanSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="mealPlanSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="mealPlanDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper flex-col items-stretch">
                <label for="dietGoalInput" class="sr-only">உணவு இலக்கு</label>
                <input type="text" id="dietGoalInput" class="input-field mb-4" placeholder="எ.கா. எடை குறைப்பு, தசை வளர்ச்சி..." aria-label="உணவு இலக்கு">

                <label for="dietPreferenceSelect" class="sr-only">உணவு விருப்பம்</label>
                <select id="dietPreferenceSelect" class="input-field mb-4" aria-label="உணவு விருப்பம்">
                    <option value="">உணவு விருப்பத்தைத் தேர்ந்தெடுக்கவும்</option>
                    <option value="vegetarian">சைவம்</option>
                    <option value="non-vegetarian">அசைவம்</option>
                    <option value="vegan">முழு சைவம்</option>
                </select>

                <label for="allergiesInput" class="sr-only">ஒவ்வாமைகள் (இருப்பின்)</label>
                <input type="text" id="allergiesInput" class="input-field mb-4" placeholder="எ.கா. நிலக்கடலை, பால்..." aria-label="ஒவ்வாமைகள்">
            </div>
            <button id="generateMealPlanBtn" class="action-button mt-4"></button>
            <div id="mealPlanOutput" class="result-box mt-4 text-left" aria-live="polite"></div>
        </div>

        <div id="moodAnalysisSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="moodAnalysisSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="moodAnalysisDescription" class="text-gray-600 mb-4 text-lg"></p>
            <button id="analyzeMoodJournalBtn" class="action-button mt-4"></button>
            <div id="moodAnalysisOutput" class="result-box mt-4 text-left" aria-live="polite"></div>
        </div>

        <div id="exerciseYogaSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="exerciseYogaSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="exerciseYogaDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper flex-col items-stretch">
                <label for="fitnessLevelSelect" class="sr-only">உடற்பயிற்சி நிலை</label>
                <select id="fitnessLevelSelect" class="input-field mb-4" aria-label="உடற்பயிற்சி நிலை">
                    <option value="">உடற்பயிற்சி நிலையைத் தேர்ந்தெடுக்கவும்</option>
                    <option value="beginner">ஆரம்பநிலை</option>
                    <option value="intermediate">நடுநிலை</option>
                    <option value="advanced">மேம்பட்டது</option>
                </select>

                <label for="timeAvailableInput" class="sr-only">கிடைக்கக்கூடிய நேரம் (நிமிடங்கள்)</label>
                <input type="number" id="timeAvailableInput" class="input-field mb-4" placeholder="கிடைக்கக்கூடிய நேரம் (நிமிடங்கள்)..." aria-label="கிடைக்கக்கூடிய நேரம்">

                <label for="exerciseGoalInput" class="sr-only">உடற்பயிற்சி இலக்கு</label>
                <input type="text" id="exerciseGoalInput" class="input-field mb-4" placeholder="எ.கா. உடல் நெகிழ்வுத்தன்மை, தசைகளை உருவாக்குதல்..." aria-label="உடற்பயிற்சி இலக்கு">
            </div>
            <button id="generateExerciseRoutineBtn" class="action-button mt-4"></button>
            <div id="exerciseRoutineOutput" class="result-box mt-4 text-left" aria-live="polite"></div>
        </div>

        <div id="diseasePreventionSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="diseasePreventionSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="diseasePreventionDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper mb-4">
                <input type="text" id="healthConcernInput" class="input-field" aria-label="உடல்நலக் கவலையை உள்ளிடவும்" placeholder="எ.கா. ஜலதோஷம், செரிமானப் பிரச்சனை...">
            </div>
            <button id="getRemedyBtn" class="generate-button"></button>
            <div id="remedyOutput" class="tip-box" aria-live="polite"></div>
        </div>

        <div id="wellnessChallengeSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="wellnessChallengeSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="wellnessChallengeDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper flex-col items-stretch">
                <label for="currentHabitInput" class="sr-only">தற்போதைய பழக்கம் (எ.கா. நீர் உட்கொள்ளல்)</label>
                <input type="text" id="currentHabitInput" class="input-field mb-4" placeholder="உங்கள் தற்போதைய பழக்கம் (எ.கா. 1000ml தண்ணீர்)..." aria-label="தற்போதைய பழக்கம்">
                
                <label for="challengeGoalInput" class="sr-only">சவால் இலக்கு (எ.கா. 2000ml தண்ணீர்)</label>
                <input type="text" id="challengeGoalInput" class="input-field mb-4" placeholder="உங்கள் சவால் இலக்கு (எ.கா. 2000ml தண்ணீர்)..." aria-label="சவால் இலக்கு">
            </div>
            <button id="generateChallengeBtn" class="action-button mt-4"></button>
            <div id="challengeOutput" class="result-box mt-4 text-left" aria-live="polite"></div>
        </div>

        <div id="medicationReminderSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="medicationReminderSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="medicationReminderDescription" class="text-gray-600 mb-4 text-lg"></p>

            <div class="input-wrapper flex-col items-stretch mb-4">
                <label for="medicationNameInput" class="sr-only">மருந்தின் பெயர்</label>
                <input type="text" id="medicationNameInput" class="input-field mb-4" placeholder="மருந்தின் பெயர்..." aria-label="மருந்தின் பெயர்">

                <label for="medicationTimeInput" class="sr-only">நேரம்</label>
                <input type="time" id="medicationTimeInput" class="input-field mb-4" aria-label="நேரம்">

                <label for="medicationFrequencySelect" class="sr-only">நினைவூட்டல் அதிர்வெண்</label>
                <select id="medicationFrequencySelect" class="input-field mb-4" aria-label="நினைவூட்டல் அதிர்வெண்">
                    <option value="">நினைவூட்டல் அதிர்வெண்ணைத் தேர்ந்தெடுக்கவும்</option>
                    <option value="daily">தினமும்</option>
                    <option value="weekly">வாராந்திர</option>
                    <option value="once">ஒரு முறை</option>
                </select>
            </div>
            <button id="addMedicationReminderBtn" class="action-button mt-4"></button>
            <div id="medicationRemindersOutput" class="result-box mt-4 text-left" aria-live="polite">
                <h3 class="text-xl font-semibold text-gray-700 mb-3" id="activeRemindersTitle"></h3>
                <ul id="activeRemindersList" class="list-disc pl-5">
                    </ul>
                <p id="noRemindersMessage" class="text-gray-500 italic mt-2"></p>
            </div>
        </div>

        <div id="bodyPainMappingSection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="bodyPainMappingSectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="bodyPainMappingDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="body-map-container mb-4">
                <img src="https://via.placeholder.com/300x500/E6F7FF/000000?text=Body+Map" alt="Human body map" class="body-map-image" id="bodyMapImage">
                <div id="painDotsContainer"></div>
            </div>
            <button id="recordPainBtn" class="action-button mt-4"></button>
            <div id="painPointsOutput" class="result-box mt-4 text-left" aria-live="polite"></div>
        </div>

        <div id="firstAidEmergencySection" class="feature-section">
            <button class="back-to-main-button" data-target="featuresListView">← பின்செல்</button>
            <h2 id="firstAidEmergencySectionTitle" class="text-2xl font-semibold text-gray-700 mb-4 mt-4"></h2>
            <p id="firstAidEmergencyDescription" class="text-gray-600 mb-4 text-lg"></p>
            <div class="input-wrapper mb-4">
                <input type="text" id="emergencyInput" class="input-field" aria-label="அவசர நிலையை உள்ளிடவும்" placeholder="எ.கா. வெட்டு, தீக்காயம், மயக்கம்...">
            </div>
            <button id="getEmergencyAdviceBtn" class="generate-button"></button>
            <div id="emergencyAdviceOutput" class="tip-box" aria-live="polite"></div>
        </div>

    </div>

    <script>
        // Language specific text content
        const translations = {
            ta: {
                mainTitle: "ஆரோக்கிய நண்பன்",
                descriptionText: "உங்கள் உடல்நல இலக்குகளை அடைய உதவும் தனிப்பயனாக்கப்பட்ட ஆரோக்கிய குறிப்புகளைப் பெறுங்கள்.",
                tipSectionTitle: "உங்கள் ஆரோக்கிய இலக்கை உள்ளிடவும்",
                goalInputPlaceholder: "எ.கா. அதிக ஆற்றல், மன அழுத்தம் குறைத்தல், நன்றாக தூங்குதல்...",
                generateButton: "குறிப்பு உருவாக்கு 💡",
                loadingText: "குறிப்புகளை உருவாக்குகிறேன்...",
                tipOutputDefault: "உங்கள் இலக்கை உள்ளிட்டு ஒரு ஆரோக்கிய குறிப்பைப் பெறுங்கள்!",
                aiVoiceButton: "AI குரலில் கேட்க 🔊",
                featuresTitle: "அம்சங்கள்",
                showFeaturesLabel: "அம்சங்களைக் காண்க",
                featuresPageTitle: "எங்கள் அம்சங்களை ஆராயுங்கள்",
                backButton: "← பின்செல்",
                stepTrackerLabel: "படிகள்",
                stepSectionTitle: "படி டிராக்கர்",
                addOneStepBtn: "ஒரு படி சேர்",
                toggleTrackingBtn: "டிராக்கிங்கை தொடங்கு/நிறுத்து",
                resetStepsBtn: "மீட்டமை",
                stepResultOutputDefault: "நீங்கள் இன்று எத்தனை படிகள் எடுத்துள்ளீர்கள் என்று கண்காணிக்கவும்.",
                heartRateTrackerLabel: "இதயத் துடிப்பு",
                heartRateSectionTitle: "இதயத் துடிப்பு டிராக்கர்",
                simulateHeartRateBtn: "இதயத் துடிப்பை உருவகப்படுத்து",
                resetHeartRateBtn: "மீட்டமை",
                heartRateResultOutputDefault: "உங்கள் இதயத் துடிப்பு இங்கே காண்பிக்கப்படும்.",
                waterTrackerLabel: "நீர்",
                waterSectionTitle: "தண்ணீர் டிராக்கர்",
                addWaterBtn: "200ml சேர்",
                resetWaterBtn: "மீட்டமை",
                waterResultOutputDefault: "நீங்கள் இன்று எவ்வளவு தண்ணீர் குடித்துள்ளீர்கள் என்று கண்காணிக்கவும்.",
                journalLabel: "ஜர்னல்",
                journalSectionTitle: "மனநிலை & நன்றியுணர்வு ஜர்னல்",
                journalDescription: "உங்கள் மனநிலையையும், நீங்கள் நன்றியுள்ள விஷயங்களையும் பதிவு செய்யுங்கள்.",
                moodSelectPlaceholder: "உங்கள் மனநிலையைத் தேர்ந்தெடுக்கவும்",
                gratitudeInputPlaceholder: "நீங்கள் நன்றியுள்ள ஒரு விஷயத்தை எழுதுங்கள்...",
                saveJournalEntryBtn: "சேமி",
                journalEntriesOutputDefault: "உங்கள் ஜர்னல் உள்ளீடுகள் இங்கே காண்பிக்கப்படும்.",
                localTipsLabel: "உள்ளூர் குறிப்புகள்",
                localTipsSectionTitle: "உள்ளூர் ஆரோக்கிய குறிப்புகள்",
                localTipsDescription: "குறிப்பிட்ட உள்ளூர் பொருட்கள் அல்லது பாரம்பரிய முறைகள் பற்றிய ஆரோக்கிய குறிப்புகளைப் பெறுங்கள்.",
                localTipCategoryPlaceholder: "எ.கா. மஞ்சள், முருங்கை, தியானம்...",
                getLocalTipBtn: "குறிப்பைப் பெறு",
                localTipOutputDefault: "உள்ளூர் ஆரோக்கிய குறிப்பைப் பெற ஒரு வகையை உள்ளிடவும்.",
                mealPlanLabel: "உணவுத் திட்டம்",
                mealPlanSectionTitle: "உணவுத் திட்டப் பரிந்துரைகள்",
                mealPlanDescription: "உங்கள் இலக்குகள் மற்றும் விருப்பங்களின் அடிப்படையில் தனிப்பயனாக்கப்பட்ட உணவுத் திட்டங்களைப் பெறுங்கள்.",
                dietGoalInputPlaceholder: "எ.கா. எடை குறைப்பு, தசை வளர்ச்சி...",
                dietPreferenceSelectPlaceholder: "உணவு விருப்பத்தைத் தேர்ந்தெடுக்கவும்",
                dietPreferenceVegetarian: "சைவம்",
                dietPreferenceNonVegetarian: "அசைவம்",
                dietPreferenceVegan: "முழு சைவம்",
                allergiesInputPlaceholder: "எ.கா. நிலக்கடலை, பால்...",
                generateMealPlanBtn: "உணவுத் திட்டத்தை உருவாக்கு",
                mealPlanOutputDefault: "உங்கள் உணவுத் திட்ட விவரங்களை உள்ளிட்டு ஒரு தனிப்பயனாக்கப்பட்ட திட்டத்தைப் பெறுங்கள்.",
                moodAnalysisLabel: "உணர்வு பகுப்பாய்வு",
                moodAnalysisSectionTitle: "உணர்வுப் பதிவேடு பகுப்பாய்வு",
                moodAnalysisDescription: "உங்கள் ஜர்னல் உள்ளீடுகளிலிருந்து உங்கள் மனநிலை போக்குகளை பகுப்பாய்வு செய்யுங்கள்.",
                analyzeMoodJournalBtn: "மனநிலையை பகுப்பாய்வு செய்",
                moodAnalysisOutputDefault: "உங்கள் ஜர்னல் உள்ளீடுகளிலிருந்து மனநிலை பகுப்பாய்வு காண்பிக்கப்படும்.",
                exerciseYogaLabel: "உடற்பயிற்சி & யோகா",
                exerciseYogaSectionTitle: "உடற்பயிற்சி & யோகா நடைமுறைகள்",
                exerciseYogaDescription: "உங்கள் உடற்பயிற்சி நிலை மற்றும் இலக்குகளுக்கு ஏற்ற தனிப்பயனாக்கப்பட்ட பயிற்சிகளைப் பெறுங்கள்.",
                fitnessLevelSelectPlaceholder: "உடற்பயிற்சி நிலையைத் தேர்ந்தெடுக்கவும்",
                fitnessLevelBeginner: "ஆரம்பநிலை",
                fitnessLevelIntermediate: "நடுநிலை",
                fitnessLevelAdvanced: "மேம்பட்டது",
                timeAvailableInputPlaceholder: "கிடைக்கக்கூடிய நேரம் (நிமிடங்கள்)...",
                exerciseGoalInputPlaceholder: "எ.கா. உடல் நெகிழ்வுத்தன்மை, தசைகளை உருவாக்குதல்...",
                generateExerciseRoutineBtn: "பயிற்சி திட்டத்தை உருவாக்கு",
                exerciseRoutineOutputDefault: "உங்கள் விவரங்களை உள்ளிட்டு ஒரு தனிப்பயனாக்கப்பட்ட பயிற்சி திட்டத்தைப் பெறுங்கள்.",
                diseasePreventionLabel: "நோய் தடுப்பு",
                diseasePreventionSectionTitle: "நோய் தடுப்பு & வீட்டு வைத்தியம்",
                diseasePreventionDescription: "பொதுவான உடல்நலக் கவலைகளுக்கான தடுப்பு குறிப்புகள் மற்றும் வீட்டு வைத்தியங்களைப் பெறுங்கள்.",
                healthConcernInputPlaceholder: "எ.கா. ஜலதோஷம், செரிமானப் பிரச்சனை...",
                getRemedyBtn: "தீர்வைக் கண்டறி",
                remedyOutputDefault: "நோய் தடுப்பு குறிப்புகள் அல்லது வீட்டு வைத்தியத்தைப் பெற ஒரு உடல்நலக் கவலையை உள்ளிடவும்.",
                wellnessChallengeLabel: "ஆரோக்கிய சவால்கள்",
                wellnessChallengeSectionTitle: "தனிப்பயனாக்கப்பட்ட ஆரோக்கிய சவால்கள்",
                wellnessChallengeDescription: "உங்கள் ஆரோக்கிய இலக்குகளை அடைய உதவும் தனிப்பயனாக்கப்பட்ட சவால்களை உருவாக்கவும்.",
                currentHabitInputPlaceholder: "உங்கள் தற்போதைய பழக்கம் (எ.கா. 1000ml தண்ணீர்)...",
                challengeGoalInputPlaceholder: "உங்கள் சவால் இலக்கு (எ.கா. 2000ml தண்ணீர்)...",
                generateChallengeBtn: "சவாலை உருவாக்கு",
                challengeOutputDefault: "தனிப்பயனாக்கப்பட்ட ஆரோக்கிய சவாலை உருவாக்க உங்கள் தற்போதைய பழக்கம் மற்றும் இலக்கை உள்ளிடவும்.",
                medicationReminderLabel: "மருந்து நினைவூட்டல்",
                medicationReminderSectionTitle: "மருந்து நினைவூட்டல்",
                medicationReminderDescription: "உங்கள் மருந்துகளை சரியான நேரத்தில் எடுத்துக்கொள்ள நினைவூட்டல்களை அமைக்கவும்.",
                medicationNameInputPlaceholder: "மருந்தின் பெயர்...",
                medicationTimeInputPlaceholder: "நேரம்",
                medicationFrequencySelectPlaceholder: "நினைவூட்டல் அதிர்வெண்ணைத் தேர்ந்தெடுக்கவும்",
                medicationFrequencyDaily: "தினமும்",
                medicationFrequencyWeekly: "வாராந்திர",
                medicationFrequencyOnce: "ஒரு முறை",
                addMedicationReminderBtn: "நினைவூட்டலை சேர்",
                activeRemindersTitle: "செயலில் உள்ள நினைவூட்டல்கள்:",
                noRemindersMessage: "தற்போது நினைவூட்டல்கள் எதுவும் இல்லை.",
                medicationReminderSet: " '{name}' மருந்துக்கான நினைவூட்டல் {time} மணிக்கு {frequency} ஆக அமைக்கப்பட்டது.",
                medicationReminderTaken: "நீங்கள் '{name}' மருந்தை எடுத்துக்கொண்டீர்கள்.",
                medicationReminderDeleted: " '{name}' மருந்து நினைவூட்டல் நீக்கப்பட்டது.",
                medicationNameRequired: "மருந்தின் பெயர் கட்டாயமானது.",
                medicationTimeRequired: "நேரம் கட்டாயமானது.",
                medicationFrequencyRequired: "அதிர்வெண் கட்டாயமானது.",
                bodyPainMappingLabel: "உடல் வலி மேப்பிங்",
                bodyPainMappingSectionTitle: "உடல் வலி மேப்பிங்",
                bodyPainMappingDescription: "உங்கள் உடல் வலியின் இருப்பிடத்தைக் குறிக்கவும்.",
                recordPainBtn: "வலியைக் பதிவுசெய்",
                painPointsOutputDefault: "உடல் வரைபடத்தில் வலியுள்ள பகுதிகளைக் கிளிக் செய்து பதிவுசெய்யவும்.",
                firstAidEmergencyLabel: "முதலுதவி & அவசரம்",
                firstAidEmergencySectionTitle: "முதலுதவி & அவசர உதவி",
                firstAidEmergencyDescription: "பொதுவான அவசரநிலைகளுக்கான உடனடி முதலுதவி உதவிக்குறிப்புகளைப் பெறுங்கள்.",
                emergencyInputPlaceholder: "எ.கா. வெட்டு, தீக்காயம், மயக்கம்...",
                getEmergencyAdviceBtn: "உதவிக்குறிப்பைப் பெறு",
                emergencyAdviceOutputDefault: "முதலுதவி உதவிக்குறிப்புகளைப் பெற ஒரு அவசர நிலையை உள்ளிடவும்.",
            },
            en: {
                mainTitle: "Health Friend",
                descriptionText: "Get personalized health tips to help you achieve your wellness goals.",
                tipSectionTitle: "Enter Your Health Goal",
                goalInputPlaceholder: "E.g., more energy, stress reduction, better sleep...",
                generateButton: "Generate Tip 💡",
                loadingText: "Generating tips...",
                tipOutputDefault: "Enter your goal to get a health tip!",
                aiVoiceButton: "Listen with AI Voice 🔊",
                featuresTitle: "Features",
                showFeaturesLabel: "View Features",
                featuresPageTitle: "Explore Our Features",
                backButton: "← Back",
                stepTrackerLabel: "Steps",
                stepSectionTitle: "Step Tracker",
                addOneStepBtn: "Add One Step",
                toggleTrackingBtn: "Start/Stop Tracking",
                resetStepsBtn: "Reset",
                stepResultOutputDefault: "Track how many steps you've taken today.",
                heartRateTrackerLabel: "Heart Rate",
                heartRateSectionTitle: "Heart Rate Tracker",
                simulateHeartRateBtn: "Simulate Heart Rate",
                resetHeartRateBtn: "Reset",
                heartRateResultOutputDefault: "Your heart rate will be displayed here.",
                waterTrackerLabel: "Water",
                waterSectionTitle: "Water Intake Tracker",
                addWaterBtn: "Add 200ml",
                resetWaterBtn: "Reset",
                waterResultOutputDefault: "Track how much water you've drunk today.",
                journalLabel: "Journal",
                journalSectionTitle: "Mood & Gratitude Journal",
                journalDescription: "Record your mood and what you're grateful for.",
                moodSelectPlaceholder: "Select your mood",
                gratitudeInputPlaceholder: "Write something you're grateful for...",
                saveJournalEntryBtn: "Save Entry",
                journalEntriesOutputDefault: "Your journal entries will appear here.",
                localTipsLabel: "Local Tips",
                localTipsSectionTitle: "Local Health Tips",
                localTipsDescription: "Get health tips related to specific local ingredients or traditional practices.",
                localTipCategoryPlaceholder: "E.g., Turmeric, Moringa, Meditation...",
                getLocalTipBtn: "Get Tip",
                localTipOutputDefault: "Enter a category to get a local health tip.",
                mealPlanLabel: "Meal Plan",
                mealPlanSectionTitle: "Meal Plan Recommendations",
                mealPlanDescription: "Get personalized meal plans based on your goals and preferences.",
                dietGoalInputPlaceholder: "E.g., weight loss, muscle gain...",
                dietPreferenceSelectPlaceholder: "Select diet preference",
                dietPreferenceVegetarian: "Vegetarian",
                dietPreferenceNonVegetarian: "Non-Vegetarian",
                dietPreferenceVegan: "Vegan",
                allergiesInputPlaceholder: "E.g., peanuts, dairy...",
                generateMealPlanBtn: "Generate Meal Plan",
                mealPlanOutputDefault: "Enter your dietary details to get a personalized plan.",
                moodAnalysisLabel: "Mood Analysis",
                moodAnalysisSectionTitle: "Mood Journal Analysis",
                moodAnalysisDescription: "Analyze your mood trends from your journal entries.",
                analyzeMoodJournalBtn: "Analyze Mood",
                moodAnalysisOutputDefault: "Mood analysis from your journal entries will be displayed here.",
                exerciseYogaLabel: "Exercise & Yoga",
                exerciseYogaSectionTitle: "Exercise & Yoga Routines",
                exerciseYogaDescription: "Get personalized exercise routines suitable for your fitness level and goals.",
                fitnessLevelSelectPlaceholder: "Select fitness level",
                fitnessLevelBeginner: "Beginner",
                fitnessLevelIntermediate: "Intermediate",
                fitnessLevelAdvanced: "Advanced",
                timeAvailableInputPlaceholder: "Time available (minutes)...",
                exerciseGoalInputPlaceholder: "E.g., flexibility, build muscle...",
                generateExerciseRoutineBtn: "Generate Routine",
                exerciseRoutineOutputDefault: "Enter your details to get a personalized exercise routine.",
                diseasePreventionLabel: "Disease Prevention",
                diseasePreventionSectionTitle: "Disease Prevention & Home Remedies",
                diseasePreventionDescription: "Get preventive tips and home remedies for common health concerns.",
                healthConcernInputPlaceholder: "E.g., common cold, digestion issues...",
                getRemedyBtn: "Find Remedy",
                remedyOutputDefault: "Enter a health concern to get prevention tips or a home remedy.",
                wellnessChallengeLabel: "Wellness Challenges",
                wellnessChallengeSectionTitle: "Personalized Wellness Challenges",
                wellnessChallengeDescription: "Create custom challenges to help you achieve your health goals.",
                currentHabitInputPlaceholder: "Your current habit (e.g., 1000ml water)...",
                challengeGoalInputPlaceholder: "Your challenge goal (e.g., 2000ml water)...",
                generateChallengeBtn: "Generate Challenge",
                challengeOutputDefault: "Enter your current habit and goal to create a personalized wellness challenge.",
                medicationReminderLabel: "Medication Reminder",
                medicationReminderSectionTitle: "Medication Reminder",
                medicationReminderDescription: "Set reminders to take your medications on time.",
                medicationNameInputPlaceholder: "Medication Name...",
                medicationTimeInputPlaceholder: "Time",
                medicationFrequencySelectPlaceholder: "Select reminder frequency",
                medicationFrequencyDaily: "Daily",
                medicationFrequencyWeekly: "Weekly",
                medicationFrequencyOnce: "Once",
                addMedicationReminderBtn: "Add Reminder",
                activeRemindersTitle: "Active Reminders:",
                noRemindersMessage: "No reminders currently set.",
                medicationReminderSet: "Reminder for '{name}' set for {time} {frequency}.",
                medicationReminderTaken: "You've marked '{name}' as taken.",
                medicationReminderDeleted: "Reminder for '{name}' deleted.",
                medicationNameRequired: "Medication name is required.",
                medicationTimeRequired: "Time is required.",
                medicationFrequencyRequired: "Frequency is required.",
                bodyPainMappingLabel: "Body Pain Mapping",
                bodyPainMappingSectionTitle: "Body Pain Mapping",
                bodyPainMappingDescription: "Mark the location of your body pain on the map.",
                recordPainBtn: "Record Pain",
                painPointsOutputDefault: "Click on the body map to mark and record pain points.",
                firstAidEmergencyLabel: "First Aid & Emergency",
                firstAidEmergencySectionTitle: "First Aid & Emergency Help",
                firstAidEmergencyDescription: "Get immediate first aid tips for common emergencies.",
                emergencyInputPlaceholder: "E.g., cut, burn, fainting...",
                getEmergencyAdviceBtn: "Get Advice",
                emergencyAdviceOutputDefault: "Enter an emergency situation to get first aid advice.",
            }
        };

        let currentLanguage = 'ta'; // Default language

        // Splash screen functionality
        window.addEventListener('load', () => {
            const splashScreen = document.getElementById('splashScreen');
            const mainContent = document.getElementById('mainContent');

            setTimeout(() => {
                splashScreen.classList.add('fade-out');
                splashScreen.addEventListener('transitionend', () => {
                    splashScreen.style.display = 'none';
                    mainContent.style.display = 'block';
                    mainContent.classList.add('active'); // Apply initial animation if needed
                    updateContent(); // Update content after splash screen
                }, { once: true });
            }, 1000); // Display splash screen for 1 second
        });

        // Function to update content based on selected language
        function updateContent() {
            const lang = currentLanguage;
            const text = translations[lang];

            // Main View
            document.getElementById('mainTitle').textContent = text.mainTitle;
            document.getElementById('descriptionText').textContent = text.descriptionText;
            document.getElementById('tipSectionTitle').textContent = text.tipSectionTitle;
            document.getElementById('goalInput').placeholder = text.goalInputPlaceholder;
            document.getElementById('generateBtn').textContent = text.generateButton;
            document.getElementById('loadingText').textContent = text.loadingText;
            document.getElementById('tipOutput').textContent = text.tipOutputDefault;
            document.getElementById('aiVoiceBtn').textContent = text.aiVoiceButton;
            document.getElementById('featuresTitle').textContent = text.featuresTitle;
            document.querySelector('#toggleFeaturesBtn .label').textContent = text.showFeaturesLabel;

            // Features List View
            document.getElementById('backToMainFromFeaturesList').textContent = text.backButton;
            document.getElementById('featuresPageTitle').textContent = text.featuresPageTitle;
            document.querySelector('#iconStepTracker .label').textContent = text.stepTrackerLabel;
            document.querySelector('#iconHeartRateTracker .label').textContent = text.heartRateTrackerLabel;
            document.querySelector('#iconWaterTracker .label').textContent = text.waterTrackerLabel;
            document.querySelector('#iconJournal .label').textContent = text.journalLabel;
            document.querySelector('#iconLocalTips .label').textContent = text.localTipsLabel;
            document.querySelector('#iconMealPlan .label').textContent = text.mealPlanLabel;
            document.querySelector('#iconMoodAnalysis .label').textContent = text.moodAnalysisLabel;
            document.querySelector('#iconExerciseYoga .label').textContent = text.exerciseYogaLabel;
            document.querySelector('#iconDiseasePrevention .label').textContent = text.diseasePreventionLabel;
            document.querySelector('#iconWellnessChallenge .label').textContent = text.wellnessChallengeLabel;
            document.querySelector('#iconMedicationReminder .label').textContent = text.medicationReminderLabel;
            document.querySelector('#iconBodyPainMapping .label').textContent = text.bodyPainMappingLabel;
            document.querySelector('#iconFirstAidEmergency .label').textContent = text.firstAidEmergencyLabel;

            // Step Tracker Section
            document.getElementById('stepSectionTitle').textContent = text.stepSectionTitle;
            document.getElementById('addOneStepBtn').textContent = text.addOneStepBtn;
            document.getElementById('toggleTrackingBtn').textContent = text.toggleTrackingBtn;
            document.getElementById('resetStepsBtn').textContent = text.resetStepsBtn;
            document.getElementById('stepResultOutput').textContent = text.stepResultOutputDefault;

            // Heart Rate Tracker Section
            document.getElementById('heartRateSectionTitle').textContent = text.heartRateSectionTitle;
            document.getElementById('simulateHeartRateBtn').textContent = text.simulateHeartRateBtn;
            document.getElementById('resetHeartRateBtn').textContent = text.resetHeartRateBtn;
            document.getElementById('heartRateResultOutput').textContent = text.heartRateResultOutputDefault;

            // Water Tracker Section
            document.getElementById('waterSectionTitle').textContent = text.waterSectionTitle;
            document.getElementById('addWaterBtn').textContent = text.addWaterBtn;
            document.getElementById('resetWaterBtn').textContent = text.resetWaterBtn;
            document.getElementById('waterResultOutput').textContent = text.waterResultOutputDefault;

            // Journal Section
            document.getElementById('journalSectionTitle').textContent = text.journalSectionTitle;
            document.getElementById('journalDescription').textContent = text.journalDescription;
            document.getElementById('moodSelect').querySelector('option[value=""]').textContent = text.moodSelectPlaceholder;
            document.getElementById('moodSelect').querySelector('option[value="happy"]').textContent = text.moodSelectPlaceholder.includes('Select') ? 'Happy 😄' : 'மகிழ்ச்சி 😄'; // Adjust options based on language
            document.getElementById('moodSelect').querySelector('option[value="neutral"]').textContent = text.moodSelectPlaceholder.includes('Select') ? 'Neutral 😐' : 'சாதாரணம் 😐';
            document.getElementById('moodSelect').querySelector('option[value="sad"]').textContent = text.moodSelectPlaceholder.includes('Select') ? 'Sad 😔' : 'சோகம் 😔';
            document.getElementById('moodSelect').querySelector('option[value="stressed"]').textContent = text.moodSelectPlaceholder.includes('Select') ? 'Stressed 😩' : 'மன அழுத்தம் 😩';
            document.getElementById('moodSelect').querySelector('option[value="energetic"]').textContent = text.moodSelectPlaceholder.includes('Select') ? 'Energetic 💪' : 'ஆற்றல் 💪';
            document.getElementById('gratitudeInput').placeholder = text.gratitudeInputPlaceholder;
            document.getElementById('saveJournalEntryBtn').textContent = text.saveJournalEntryBtn;
            document.getElementById('journalEntriesOutput').textContent = text.journalEntriesOutputDefault;

            // Local Tips Section
            document.getElementById('localTipsSectionTitle').textContent = text.localTipsSectionTitle;
            document.getElementById('localTipsDescription').textContent = text.localTipsDescription;
            document.getElementById('localTipCategory').placeholder = text.localTipCategoryPlaceholder;
            document.getElementById('getLocalTipBtn').textContent = text.getLocalTipBtn;
            document.getElementById('localTipOutput').textContent = text.localTipOutputDefault;

            // Meal Plan Section
            document.getElementById('mealPlanSectionTitle').textContent = text.mealPlanSectionTitle;
            document.getElementById('mealPlanDescription').textContent = text.mealPlanDescription;
            document.getElementById('dietGoalInput').placeholder = text.dietGoalInputPlaceholder;
            document.getElementById('dietPreferenceSelect').querySelector('option[value=""]').textContent = text.dietPreferenceSelectPlaceholder;
            document.getElementById('dietPreferenceSelect').querySelector('option[value="vegetarian"]').textContent = text.dietPreferenceVegetarian;
            document.getElementById('dietPreferenceSelect').querySelector('option[value="non-vegetarian"]').textContent = text.dietPreferenceNonVegetarian;
            document.getElementById('dietPreferenceSelect').querySelector('option[value="vegan"]').textContent = text.dietPreferenceVegan;
            document.getElementById('allergiesInput').placeholder = text.allergiesInputPlaceholder;
            document.getElementById('generateMealPlanBtn').textContent = text.generateMealPlanBtn;
            document.getElementById('mealPlanOutput').textContent = text.mealPlanOutputDefault;

            // Mood Analysis Section
            document.getElementById('moodAnalysisSectionTitle').textContent = text.moodAnalysisSectionTitle;
            document.getElementById('moodAnalysisDescription').textContent = text.moodAnalysisDescription;
            document.getElementById('analyzeMoodJournalBtn').textContent = text.analyzeMoodJournalBtn;
            document.getElementById('moodAnalysisOutput').textContent = text.moodAnalysisOutputDefault;

            // Exercise Yoga Section
            document.getElementById('exerciseYogaSectionTitle').textContent = text.exerciseYogaSectionTitle;
            document.getElementById('exerciseYogaDescription').textContent = text.exerciseYogaDescription;
            document.getElementById('fitnessLevelSelect').querySelector('option[value=""]').textContent = text.fitnessLevelSelectPlaceholder;
            document.getElementById('fitnessLevelSelect').querySelector('option[value="beginner"]').textContent = text.fitnessLevelBeginner;
            document.getElementById('fitnessLevelSelect').querySelector('option[value="intermediate"]').textContent = text.fitnessLevelIntermediate;
            document.getElementById('fitnessLevelSelect').querySelector('option[value="advanced"]').textContent = text.fitnessLevelAdvanced;
            document.getElementById('timeAvailableInput').placeholder = text.timeAvailableInputPlaceholder;
            document.getElementById('exerciseGoalInput').placeholder = text.exerciseGoalInputPlaceholder;
            document.getElementById('generateExerciseRoutineBtn').textContent = text.generateExerciseRoutineBtn;
            document.getElementById('exerciseRoutineOutput').textContent = text.exerciseRoutineOutputDefault;

            // Disease Prevention Section
            document.getElementById('diseasePreventionSectionTitle').textContent = text.diseasePreventionSectionTitle;
            document.getElementById('diseasePreventionDescription').textContent = text.diseasePreventionDescription;
            document.getElementById('healthConcernInput').placeholder = text.healthConcernInputPlaceholder;
            document.getElementById('getRemedyBtn').textContent = text.getRemedyBtn;
            document.getElementById('remedyOutput').textContent = text.remedyOutputDefault;

            // Wellness Challenge Section
            document.getElementById('wellnessChallengeSectionTitle').textContent = text.wellnessChallengeSectionTitle;
            document.getElementById('wellnessChallengeDescription').textContent = text.wellnessChallengeDescription;
            document.getElementById('currentHabitInput').placeholder = text.currentHabitInputPlaceholder;
            document.getElementById('challengeGoalInput').placeholder = text.challengeGoalInputPlaceholder;
            document.getElementById('generateChallengeBtn').textContent = text.generateChallengeBtn;
            document.getElementById('challengeOutput').textContent = text.challengeOutputDefault;

            // Medication Reminder Section
            document.getElementById('medicationReminderSectionTitle').textContent = text.medicationReminderSectionTitle;
            document.getElementById('medicationReminderDescription').textContent = text.medicationReminderDescription;
            document.getElementById('medicationNameInput').placeholder = text.medicationNameInputPlaceholder;
            document.getElementById('medicationTimeInput').setAttribute('aria-label', text.medicationTimeInputPlaceholder);
            document.getElementById('medicationFrequencySelect').querySelector('option[value=""]').textContent = text.medicationFrequencySelectPlaceholder;
            document.getElementById('medicationFrequencySelect').querySelector('option[value="daily"]').textContent = text.medicationFrequencyDaily;
            document.getElementById('medicationFrequencySelect').querySelector('option[value="weekly"]').textContent = text.medicationFrequencyWeekly;
            document.getElementById('medicationFrequencySelect').querySelector('option[value="once"]').textContent = text.medicationFrequencyOnce;
            document.getElementById('addMedicationReminderBtn').textContent = text.addMedicationReminderBtn;
            document.getElementById('activeRemindersTitle').textContent = text.activeRemindersTitle;
            document.getElementById('noRemindersMessage').textContent = text.noRemindersMessage;
            renderMedicationReminders(); // Re-render reminders with new language

            // Body Pain Mapping Section
            document.getElementById('bodyPainMappingSectionTitle').textContent = text.bodyPainMappingSectionTitle;
            document.getElementById('bodyPainMappingDescription').textContent = text.bodyPainMappingDescription;
            document.getElementById('recordPainBtn').textContent = text.recordPainBtn;
            document.getElementById('painPointsOutput').textContent = text.painPointsOutputDefault;

            // First Aid Emergency Section
            document.getElementById('firstAidEmergencySectionTitle').textContent = text.firstAidEmergencySectionTitle;
            document.getElementById('firstAidEmergencyDescription').textContent = text.firstAidEmergencyDescription;
            document.getElementById('emergencyInput').placeholder = text.emergencyInputPlaceholder;
            document.getElementById('getEmergencyAdviceBtn').textContent = text.getEmergencyAdviceBtn;
            document.getElementById('emergencyAdviceOutput').textContent = text.emergencyAdviceOutputDefault;
        }

        // Language selection
        document.getElementById('languageSelect').addEventListener('change', (event) => {
            currentLanguage = event.target.value;
            updateContent();
        });

        // Initialize content on page load
        document.addEventListener('DOMContentLoaded', updateContent);

        // --- Feature Navigation ---
        const initialView = document.getElementById('initialView');
        const featuresListView = document.getElementById('featuresListView');
        const featureSections = document.querySelectorAll('.feature-section');
        const toggleFeaturesBtn = document.getElementById('toggleFeaturesBtn');
        const backToMainFromFeaturesList = document.getElementById('backToMainFromFeaturesList');
        const featureIcons = document.querySelectorAll('.feature-icon');
        const backButtons = document.querySelectorAll('.back-to-main-button[data-target]');

        toggleFeaturesBtn.addEventListener('click', () => {
            initialView.style.display = 'none';
            featuresListView.style.display = 'block';
        });

        backToMainFromFeaturesList.addEventListener('click', () => {
            featuresListView.style.display = 'none';
            initialView.style.display = 'block';
        });

        featureIcons.forEach(icon => {
            icon.addEventListener('click', () => {
                const targetSectionId = icon.dataset.section;
                const targetSection = document.getElementById(targetSectionId);
                if (targetSection) {
                    featuresListView.style.display = 'none';
                    featureSections.forEach(section => section.style.display = 'none'); // Hide all sections
                    targetSection.style.display = 'block'; // Show target section
                }
            });
        });

        backButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                const targetViewId = event.target.dataset.target;
                featureSections.forEach(section => section.style.display = 'none'); // Hide all feature sections
                document.getElementById(targetViewId).style.display = 'block'; // Show the target view (e.g., featuresListView)
            });
        });

        // --- Core Functionality (AI Tip Generation) ---
        const goalInput = document.getElementById('goalInput');
        const generateBtn = document.getElementById('generateBtn');
        const tipOutput = document.getElementById('tipOutput');
        const loadingIndicator = document.getElementById('loading');
        const micBtn = document.getElementById('micBtn');
        const aiVoiceBtn = document.getElementById('aiVoiceBtn');
        const ttsVoiceSelect = document.getElementById('ttsVoiceSelect');

        let recognition; // SpeechRecognition object
        let synth = window.speechSynthesis; // Web Speech API SpeechSynthesis object
        let voices = []; // Array to store available voices
        let currentUtterance = null; // To keep track of the current speech utterance

        // Populate TTS voices
        function populateVoiceList() {
            voices = synth.getVoices().filter(voice => voice.lang.startsWith(currentLanguage === 'ta' ? 'ta' : 'en'));
            ttsVoiceSelect.innerHTML = ''; // Clear existing options
            voices.forEach(voice => {
                const option = document.createElement('option');
                option.textContent = `${voice.name} (${voice.lang})`;
                option.value = voice.name;
                option.setAttribute('data-lang', voice.lang);
                if (voice.default) {
                    option.selected = true;
                }
                ttsVoiceSelect.appendChild(option);
            });
            if (voices.length > 0) {
                aiVoiceBtn.style.display = 'inline-flex';
                ttsVoiceSelect.style.display = 'inline-block';
            } else {
                aiVoiceBtn.style.display = 'none';
                ttsVoiceSelect.style.display = 'none';
            }
        }

        populateVoiceList();
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoiceList;
        }

        // Speech Recognition
        if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
            recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.continuous = false;
            recognition.lang = currentLanguage === 'ta' ? 'ta-IN' : 'en-US'; // Set language for recognition
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            micBtn.addEventListener('click', () => {
                micBtn.classList.add('recording');
                goalInput.value = ''; // Clear input before recording
                tipOutput.textContent = translations[currentLanguage].tipOutputDefault;
                recognition.start();
            });

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                goalInput.value = transcript;
                micBtn.classList.remove('recording');
                generateHealthTip(); // Automatically generate tip after speech input
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                micBtn.classList.remove('recording');
                tipOutput.textContent = `Error: ${event.error}. Please try again.`;
            };

            recognition.onend = () => {
                micBtn.classList.remove('recording');
            };
        } else {
            micBtn.style.display = 'none'; // Hide mic button if not supported
            console.warn('Speech Recognition API not supported in this browser.');
        }

        // Text-to-Speech
        aiVoiceBtn.addEventListener('click', () => {
            if (synth.speaking && currentUtterance) {
                synth.cancel(); // Stop current speech if speaking
                aiVoiceBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-2">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M23.31 1.69a16 16 0 0 1 0 20.62"></path>
                                        </svg> ${translations[currentLanguage].aiVoiceButton.split(' ')[0]} ${translations[currentLanguage].aiVoiceButton.split(' ')[1]}`;
            } else {
                const textToSpeak = tipOutput.textContent;
                if (textToSpeak && textToSpeak !== translations[currentLanguage].tipOutputDefault) {
                    currentUtterance = new SpeechSynthesisUtterance(textToSpeak);
                    const selectedVoiceName = ttsVoiceSelect.value;
                    const selectedVoice = voices.find(voice => voice.name === selectedVoiceName);
                    if (selectedVoice) {
                        currentUtterance.voice = selectedVoice;
                    }
                    currentUtterance.lang = currentLanguage === 'ta' ? 'ta-IN' : 'en-US'; // Ensure correct language for speech
                    
                    currentUtterance.onstart = () => {
                        aiVoiceBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-X">
                                                    <path d="M11 5 6 9 2 9 2 15 6 15 11 19z"></path>
                                                    <line x1="22" y1="9" x2="16" y2="15"></line>
                                                    <line x1="16" y1="9" x2="22" y2="15"></line>
                                                </svg> Stop Speaking`;
                    };

                    currentUtterance.onend = () => {
                        aiVoiceBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-2">
                                                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14M23.31 1.69a16 16 0 0 1 0 20.62"></path>
                                                </svg> ${translations[currentLanguage].aiVoiceButton.split(' ')[0]} ${translations[currentLanguage].aiVoiceButton.split(' ')[1]}`;
                    };

                    currentUtterance.onerror = (event) => {
                        console.error('SpeechSynthesisUtterance.onerror', event);
                        aiVoiceBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-2">
                                                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14M23.31 1.69a16 16 0 0 1 0 20.62"></path>
                                                </svg> ${translations[currentLanguage].aiVoiceButton.split(' ')[0]} ${translations[currentLanguage].aiVoiceButton.split(' ')[1]}`;
                    };

                    synth.speak(currentUtterance);
                }
            }
        });

        // Generate Health Tip (Simulated AI Response)
        generateBtn.addEventListener('click', generateHealthTip);

        async function generateHealthTip() {
            const goal = goalInput.value.trim();
            if (!goal) {
                tipOutput.textContent = translations[currentLanguage].tipOutputDefault;
                return;
            }

            loadingIndicator.style.display = 'flex';
            tipOutput.style.display = 'none';

            // Simulate API call or complex processing
            await new Promise(resolve => setTimeout(resolve, 1500));

            let tip = "";
            if (currentLanguage === 'ta') {
                if (goal.includes('ஆற்றல்')) {
                    tip = "தினமும் காலை உணவில் ஒரு கிளாஸ் பழச்சாற்றுடன், சிறிது ஊறவைத்த பாதாம் பருப்புகளைச் சேர்த்துக்கொள்ளுங்கள். இது நாள் முழுவதும் உங்களுக்கு ஆற்றலை அளிக்கும்.";
                } else if (goal.includes('மன அழுத்தம்')) {
                    tip = "தியானம் அல்லது ஆழ்ந்த மூச்சுப் பயிற்சிகளுக்கு தினமும் 10-15 நிமிடங்கள் ஒதுக்குங்கள். இது மனதை அமைதிப்படுத்த உதவும்.";
                } else if (goal.includes('தூக்கம்')) {
                    tip = "படுக்கைக்குச் செல்லும் முன் மொபைல் அல்லது கணினி உபயோகிப்பதைத் தவிர்க்கவும். அதற்கு பதிலாக ஒரு புத்தகத்தைப் படிக்கலாம் அல்லது சூடான பால் குடிக்கலாம்.";
                } else {
                    tip = `உங்கள் இலக்கான "${goal}" ஐ அடைய, தினமும் 30 நிமிடங்கள் நடைபயிற்சி மேற்கொண்டு, சமச்சீர் உணவை உட்கொள்ளுங்கள்.`;
                }
            } else { // English
                if (goal.includes('energy')) {
                    tip = "Include a glass of fruit juice with soaked almonds in your breakfast daily. This will provide you energy throughout the day.";
                } else if (goal.includes('stress')) {
                    tip = "Dedicate 10-15 minutes daily to meditation or deep breathing exercises. This will help calm your mind.";
                } else if (goal.includes('sleep')) {
                    tip = "Avoid using mobile phones or computers before bed. Instead, read a book or drink warm milk.";
                } else {
                    tip = `To achieve your goal of "${goal}", take a 30-minute walk daily and consume a balanced diet.`;
                }
            }

            loadingIndicator.style.display = 'none';
            tipOutput.style.display = 'flex';
            tipOutput.textContent = tip;
        }

        // --- Step Tracker Functionality ---
        const currentStepsDisplay = document.getElementById('currentStepsDisplay');
        const addOneStepBtn = document.getElementById('addOneStepBtn');
        const toggleTrackingBtn = document.getElementById('toggleTrackingBtn');
        const resetStepsBtn = document.getElementById('resetStepsBtn');
        const stepResultOutput = document.getElementById('stepResultOutput');

        let steps = 0;
        let isTrackingSteps = false;
        let stepInterval;

        function updateStepDisplay() {
            currentStepsDisplay.value = steps;
            stepResultOutput.textContent = `${translations[currentLanguage].stepResultOutputDefault.replace('Track how many steps you\'ve taken today.', 'நீங்கள் இன்று ' + steps + ' படிகள் எடுத்துள்ளீர்கள்.')}`;
        }

        addOneStepBtn.addEventListener('click', () => {
            steps++;
            updateStepDisplay();
        });

        toggleTrackingBtn.addEventListener('click', () => {
            if (isTrackingSteps) {
                clearInterval(stepInterval);
                toggleTrackingBtn.textContent = translations[currentLanguage].toggleTrackingBtn;
                isTrackingSteps = false;
            } else {
                stepInterval = setInterval(() => {
                    steps++; // Simulate steps being added over time
                    updateStepDisplay();
                }, 2000); // Add a step every 2 seconds for simulation
                toggleTrackingBtn.textContent = translations[currentLanguage].toggleTrackingBtn.replace('Start', 'Stop').replace('தொடங்கு', 'நிறுத்து');
                isTrackingSteps = true;
            }
        });

        resetStepsBtn.addEventListener('click', () => {
            steps = 0;
            clearInterval(stepInterval);
            isTrackingSteps = false;
            toggleTrackingBtn.textContent = translations[currentLanguage].toggleTrackingBtn;
            updateStepDisplay();
        });

        // Initial update for step tracker
        updateStepDisplay();

        // --- Heart Rate Tracker Functionality ---
        const currentHeartRateDisplay = document.getElementById('currentHeartRateDisplay');
        const simulateHeartRateBtn = document.getElementById('simulateHeartRateBtn');
        const resetHeartRateBtn = document.getElementById('resetHeartRateBtn');
        const heartRateResultOutput = document.getElementById('heartRateResultOutput');

        let heartRate = 0;
        let heartRateInterval;

        function updateHeartRateDisplay() {
            currentHeartRateDisplay.value = heartRate > 0 ? `${heartRate} bpm` : '0';
            if (heartRate > 0) {
                let status = '';
                if (currentLanguage === 'ta') {
                    status = heartRate >= 60 && heartRate <= 100 ? 'சாதாரணமாக உள்ளது' : 'சாதாரண வரம்பிற்கு வெளியே';
                    heartRateResultOutput.textContent = `உங்கள் இதயத் துடிப்பு: ${heartRate} bpm. இது ${status}.`;
                } else {
                    status = heartRate >= 60 && heartRate <= 100 ? 'normal' : 'outside normal range';
                    heartRateResultOutput.textContent = `Your heart rate: ${heartRate} bpm. This is ${status}.`;
                }
            } else {
                heartRateResultOutput.textContent = translations[currentLanguage].heartRateResultOutputDefault;
            }
        }

        simulateHeartRateBtn.addEventListener('click', () => {
            clearInterval(heartRateInterval);
            let simulatedRate = Math.floor(Math.random() * (120 - 50 + 1)) + 50; // Between 50 and 120 bpm
            heartRate = simulatedRate;
            updateHeartRateDisplay();
            // Simulate changing heart rate slightly over time
            heartRateInterval = setInterval(() => {
                heartRate += Math.floor(Math.random() * 5) - 2; // Add/subtract up to 2 bpm
                if (heartRate < 40) heartRate = 40;
                if (heartRate > 150) heartRate = 150;
                updateHeartRateDisplay();
            }, 3000);
        });

        resetHeartRateBtn.addEventListener('click', () => {
            clearInterval(heartRateInterval);
            heartRate = 0;
            updateHeartRateDisplay();
        });

        updateHeartRateDisplay(); // Initial display

        // --- Water Tracker Functionality ---
        const waterIntakeDisplay = document.getElementById('waterIntakeDisplay');
        const addWaterBtn = document.getElementById('addWaterBtn');
        const resetWaterBtn = document.getElementById('resetWaterBtn');
        const waterResultOutput = document.getElementById('waterResultOutput');

        let waterIntake = 0; // in ml
        const waterIncrement = 200; // ml per click
        const dailyWaterGoal = 2000; // ml

        function updateWaterDisplay() {
            waterIntakeDisplay.value = `${waterIntake} ml`;
            let message = '';
            if (currentLanguage === 'ta') {
                if (waterIntake < dailyWaterGoal) {
                    message = `நீங்கள் இன்று ${waterIntake} ml தண்ணீர் குடித்துள்ளீர்கள். உங்கள் இலக்கை அடைய இன்னும் ${dailyWaterGoal - waterIntake} ml குடிக்க வேண்டும்.`;
                } else {
                    message = `வாழ்த்துக்கள்! நீங்கள் இன்று உங்கள் ${dailyWaterGoal} ml தண்ணீர் இலக்கை அடைந்துவிட்டீர்கள்!`;
                }
            } else { // English
                if (waterIntake < dailyWaterGoal) {
                    message = `You have drunk ${waterIntake} ml of water today. Drink ${dailyWaterGoal - waterIntake} ml more to reach your goal.`;
                } else {
                    message = `Congratulations! You have reached your ${dailyWaterGoal} ml water goal today!`;
                }
            }
            waterResultOutput.textContent = message;
        }

        addWaterBtn.addEventListener('click', () => {
            waterIntake += waterIncrement;
            updateWaterDisplay();
        });

        resetWaterBtn.addEventListener('click', () => {
            waterIntake = 0;
            updateWaterDisplay();
        });

        updateWaterDisplay(); // Initial display

        // --- Journal Functionality ---
        const moodSelect = document.getElementById('moodSelect');
        const gratitudeInput = document.getElementById('gratitudeInput');
        const saveJournalEntryBtn = document.getElementById('saveJournalEntryBtn');
        const journalEntriesOutput = document.getElementById('journalEntriesOutput');

        let journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];

        function renderJournalEntries() {
            journalEntriesOutput.innerHTML = `<h3 class="text-xl font-semibold text-gray-700 mb-3">${currentLanguage === 'ta' ? 'உங்கள் ஜர்னல் உள்ளீடுகள்:' : 'Your Journal Entries:'}</h3>`;
            if (journalEntries.length === 0) {
                journalEntriesOutput.innerHTML += `<p class="text-gray-500 italic mt-2">${translations[currentLanguage].journalEntriesOutputDefault}</p>`;
            } else {
                const ul = document.createElement('ul');
                ul.className = 'list-disc pl-5 space-y-2';
                journalEntries.forEach((entry, index) => {
                    const li = document.createElement('li');
                    const date = new Date(entry.timestamp).toLocaleString(currentLanguage === 'ta' ? 'ta-IN' : 'en-US', { dateStyle: 'medium', timeStyle: 'short' });
                    let moodText = '';
                    if (currentLanguage === 'ta') {
                        switch (entry.mood) {
                            case 'happy': moodText = 'மகிழ்ச்சி 😄'; break;
                            case 'neutral': moodText = 'சாதாரணம் 😐'; break;
                            case 'sad': moodText = 'சோகம் 😔'; break;
                            case 'stressed': moodText = 'மன அழுத்தம் 😩'; break;
                            case 'energetic': moodText = 'ஆற்றல் 💪'; break;
                            default: moodText = entry.mood;
                        }
                    } else {
                         switch (entry.mood) {
                            case 'happy': moodText = 'Happy 😄'; break;
                            case 'neutral': moodText = 'Neutral 😐'; break;
                            case 'sad': moodText = 'Sad 😔'; break;
                            case 'stressed': moodText = 'Stressed 😩'; break;
                            case 'energetic': moodText = 'Energetic 💪'; break;
                            default: moodText = entry.mood;
                        }
                    }

                    li.innerHTML = `<strong>${date}</strong> - ${currentLanguage === 'ta' ? 'மனநிலை' : 'Mood'}: ${moodText}<br>${currentLanguage === 'ta' ? 'நன்றியுணர்வு' : 'Gratitude'}: "${entry.gratitude}"`;
                    ul.appendChild(li);
                });
                journalEntriesOutput.appendChild(ul);
            }
        }

        saveJournalEntryBtn.addEventListener('click', () => {
            const mood = moodSelect.value;
            const gratitude = gratitudeInput.value.trim();

            if (!mood && !gratitude) {
                alert(currentLanguage === 'ta' ? "மனநிலையையோ அல்லது நன்றியுணர்வு உள்ளீட்டையோ உள்ளிடவும்." : "Please enter either a mood or a gratitude entry.");
                return;
            }

            const newEntry = {
                mood: mood || 'not specified',
                gratitude: gratitude || 'not specified',
                timestamp: new Date().toISOString()
            };

            journalEntries.push(newEntry);
            localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
            moodSelect.value = '';
            gratitudeInput.value = '';
            renderJournalEntries();
            alert(currentLanguage === 'ta' ? "ஜர்னல் உள்ளீடு சேமிக்கப்பட்டது!" : "Journal entry saved!");
        });

        renderJournalEntries(); // Initial rendering of journal entries

        // --- Local Tips Functionality ---
        const localTipCategoryInput = document.getElementById('localTipCategory');
        const localTipCategoryDropdown = document.getElementById('localTipCategoryDropdown');
        const getLocalTipBtn = document.getElementById('getLocalTipBtn');
        const localTipOutput = document.getElementById('localTipOutput');

        const localTipData = {
            ta: {
                "மஞ்சள்": "மஞ்சள் ஒரு சக்திவாய்ந்த அழற்சி எதிர்ப்பு மற்றும் ஆண்டிசெப்டிக் ஆகும். இதை உங்கள் உணவில் சேர்த்துக்கொள்வது நோய் எதிர்ப்பு சக்தியை அதிகரிக்கவும், ஒட்டுமொத்த ஆரோக்கியத்தை மேம்படுத்தவும் உதவும்.",
                "முருங்கை": "முருங்கை இலைகள் வைட்டமின்கள், தாதுக்கள் மற்றும் ஆக்ஸிஜனேற்றங்களால் நிறைந்துள்ளன. இதை உங்கள் உணவில் சேர்த்துக்கொள்வது ஆற்றலை அதிகரிக்கவும், இரத்த சர்க்கரையை கட்டுப்படுத்தவும் உதவும்.",
                "தியானம்": "தினசரி தியானம் மன அழுத்தத்தைக் குறைக்கவும், மனத் தெளிவை மேம்படுத்தவும், உணர்ச்சி சமநிலையை மேம்படுத்தவும் உதவும். காலையில் 10-15 நிமிடங்கள் தியானம் செய்யுங்கள்.",
                "நெல்லிக்காய்": "நெல்லிக்காய் வைட்டமின் சி இன் சிறந்த மூலமாகும். இது நோய் எதிர்ப்பு சக்தியை அதிகரிக்கவும், சரும ஆரோக்கியத்தை மேம்படுத்தவும், செரிமானத்திற்கு உதவவும் பயன்படுகிறது.",
                "துளசி": "துளசி (புனித துளசி) சளி, இருமல் மற்றும் சுவாசப் பிரச்சனைகளுக்கு ஒரு பாரம்பரிய தீர்வாகும். துளசி தேநீர் குடிப்பது அல்லது இலைகளை மென்று சாப்பிடுவது நன்மை பயக்கும்.",
                "வேப்பிலை": "வேப்பிலை அதன் ஆண்டிபாக்டீரியல் மற்றும் பூஞ்சை எதிர்ப்பு பண்புகளுக்கு பெயர் பெற்றது. சரும பிரச்சனைகள் மற்றும் இரத்த சுத்திகரிப்புக்கு பயன்படுத்தப்படுகிறது."
            },
            en: {
                "Turmeric": "Turmeric is a powerful anti-inflammatory and antiseptic. Including it in your diet can boost immunity and improve overall well-being.",
                "Moringa": "Moringa leaves are packed with vitamins, minerals, and antioxidants. Adding them to your diet can help boost energy and regulate blood sugar.",
                "Meditation": "Daily meditation can significantly reduce stress, improve mental clarity, and enhance emotional balance. Practice 10-15 minutes each morning.",
                "Amla": "Amla (Indian Gooseberry) is an excellent source of Vitamin C. It's used to boost immunity, improve skin health, and aid digestion.",
                "Tulasi": "Tulasi (Holy Basil) is a traditional remedy for cold, cough, and respiratory issues. Drinking Tulasi tea or chewing its leaves can be beneficial.",
                "Neem": "Neem leaves are known for their antibacterial and antifungal properties. Used for skin conditions and blood purification."
            }
        };

        localTipCategoryInput.addEventListener('input', () => {
            const input = localTipCategoryInput.value.toLowerCase();
            const suggestions = Object.keys(localTipData[currentLanguage]).filter(key =>
                key.toLowerCase().includes(input)
            );

            localTipCategoryDropdown.innerHTML = '';
            if (suggestions.length > 0 && input.length > 0) {
                suggestions.forEach(suggestion => {
                    const div = document.createElement('div');
                    div.textContent = suggestion;
                    div.addEventListener('click', () => {
                        localTipCategoryInput.value = suggestion;
                        localTipCategoryDropdown.classList.add('hidden');
                    });
                    localTipCategoryDropdown.appendChild(div);
                });
                localTipCategoryDropdown.classList.remove('hidden');
            } else {
                localTipCategoryDropdown.classList.add('hidden');
            }
        });

        document.addEventListener('click', (event) => {
            if (!localTipCategoryInput.contains(event.target) && !localTipCategoryDropdown.contains(event.target)) {
                localTipCategoryDropdown.classList.add('hidden');
            }
        });

        getLocalTipBtn.addEventListener('click', () => {
            const category = localTipCategoryInput.value.trim();
            if (!category) {
                localTipOutput.textContent = translations[currentLanguage].localTipOutputDefault;
                return;
            }
            const tip = localTipData[currentLanguage][category] || translations[currentLanguage].localTipOutputDefault;
            localTipOutput.textContent = tip;
        });

        // --- Meal Plan Functionality (Simulated) ---
        const dietGoalInput = document.getElementById('dietGoalInput');
        const dietPreferenceSelect = document.getElementById('dietPreferenceSelect');
        const allergiesInput = document.getElementById('allergiesInput');
        const generateMealPlanBtn = document.getElementById('generateMealPlanBtn');
        const mealPlanOutput = document.getElementById('mealPlanOutput');

        generateMealPlanBtn.addEventListener('click', () => {
            const goal = dietGoalInput.value.trim();
            const preference = dietPreferenceSelect.value;
            const allergies = allergiesInput.value.trim();

            if (!goal && !preference && !allergies) {
                mealPlanOutput.textContent = translations[currentLanguage].mealPlanOutputDefault;
                return;
            }

            let mealPlan = "";
            if (currentLanguage === 'ta') {
                mealPlan = `உங்கள் இலக்கு "${goal || 'குறிப்பிடப்படவில்லை'}", உணவு விருப்பம் "${preference === 'vegetarian' ? 'சைவம்' : preference === 'non-vegetarian' ? 'அசைவம்' : preference === 'vegan' ? 'முழு சைவம்' : 'குறிப்பிடப்படவில்லை'}" மற்றும் ஒவ்வாமைகள் "${allergies || 'இல்லை'}" ஆகியவற்றின் அடிப்படையில் தனிப்பயனாக்கப்பட்ட உணவுத் திட்டம்:`;
                mealPlan += "\n\nகாலை உணவு: இட்லி/தோசை சாம்பார் மற்றும் சட்னியுடன் (அல்லது முட்டை/சிக்கன் சாலட் அசைவத்திற்கு)";
                mealPlan += "\nமதிய உணவு: அரிசி/சப்பாத்தி, பருப்பு, காய்கறி கறி, தயிர் (அல்லது மீன் கறி அசைவத்திற்கு)";
                mealPlan += "\nஇரவு உணவு: லேசான சப்பாத்தி/ஓட்ஸ், காய்கறி சூப் (அல்லது கிரில் சிக்கன் அசைவத்திற்கு)";
                mealPlan += "\n\nகுறிப்பு: தினமும் போதுமான அளவு தண்ணீர் குடிக்கவும் மற்றும் சீரான உடற்பயிற்சி செய்யவும்.";
            } else { // English
                mealPlan = `Here's a personalized meal plan based on your goal "${goal || 'not specified'}", diet preference "${preference || 'not specified'}", and allergies "${allergies || 'none'}":`;
                mealPlan += "\n\nBreakfast: Idli/Dosa with Sambar and Chutney (or Eggs/Chicken Salad for Non-Vegetarian)";
                mealPlan += "\nLunch: Rice/Chapati, Dal, Vegetable Curry, Curd (or Fish Curry for Non-Vegetarian)";
                mealPlan += "\nDinner: Light Chapati/Oats, Vegetable Soup (or Grilled Chicken for Non-Vegetarian)";
                mealPlan += "\n\nNote: Drink plenty of water daily and engage in regular exercise.";
            }
            mealPlanOutput.textContent = mealPlan;
        });

        // --- Mood Analysis Functionality (Simulated) ---
        const analyzeMoodJournalBtn = document.getElementById('analyzeMoodJournalBtn');
        const moodAnalysisOutput = document.getElementById('moodAnalysisOutput');

        analyzeMoodJournalBtn.addEventListener('click', () => {
            if (journalEntries.length === 0) {
                moodAnalysisOutput.textContent = currentLanguage === 'ta' ? "மனநிலை பகுப்பாய்வு செய்ய ஜர்னல் உள்ளீடுகள் எதுவும் இல்லை." : "No journal entries to analyze mood.";
                return;
            }

            const moodCounts = { happy: 0, neutral: 0, sad: 0, stressed: 0, energetic: 0, 'not specified': 0 };
            journalEntries.forEach(entry => {
                moodCounts[entry.mood]++;
            });

            const totalEntries = journalEntries.length;
            let analysis = currentLanguage === 'ta' ? "உங்கள் மனநிலை போக்குகளின் பகுப்பாய்வு:" : "Analysis of your mood trends:";
            analysis += "\n\n";

            for (const mood in moodCounts) {
                if (moodCounts[mood] > 0) {
                    const percentage = ((moodCounts[mood] / totalEntries) * 100).toFixed(1);
                    let moodLabel = mood;
                    if (currentLanguage === 'ta') {
                        switch (mood) {
                            case 'happy': moodLabel = 'மகிழ்ச்சி'; break;
                            case 'neutral': moodLabel = 'சாதாரணம்'; break;
                            case 'sad': moodLabel = 'சோகம்'; break;
                            case 'stressed': moodLabel = 'மன அழுத்தம்'; break;
                            case 'energetic': moodLabel = 'ஆற்றல்'; break;
                            case 'not specified': moodLabel = 'குறிப்பிடப்படாதது'; break;
                        }
                    }
                    analysis += `${moodLabel}: ${moodCounts[mood]} (${percentage}%)\n`;
                }
            }
            moodAnalysisOutput.textContent = analysis;
        });

        // --- Exercise & Yoga Functionality (Simulated) ---
        const fitnessLevelSelect = document.getElementById('fitnessLevelSelect');
        const timeAvailableInput = document.getElementById('timeAvailableInput');
        const exerciseGoalInput = document.getElementById('exerciseGoalInput');
        const generateExerciseRoutineBtn = document.getElementById('generateExerciseRoutineBtn');
        const exerciseRoutineOutput = document.getElementById('exerciseRoutineOutput');

        generateExerciseRoutineBtn.addEventListener('click', () => {
            const fitnessLevel = fitnessLevelSelect.value;
            const timeAvailable = parseInt(timeAvailableInput.value);
            const exerciseGoal = exerciseGoalInput.value.trim();

            if (!fitnessLevel || !timeAvailable || !exerciseGoal) {
                exerciseRoutineOutput.textContent = translations[currentLanguage].exerciseRoutineOutputDefault;
                return;
            }

            let routine = "";
            if (currentLanguage === 'ta') {
                routine = `உங்கள் "${fitnessLevel === 'beginner' ? 'ஆரம்பநிலை' : fitnessLevel === 'intermediate' ? 'நடுநிலை' : 'மேம்பட்டது'}" உடற்பயிற்சி நிலை, ${timeAvailable} நிமிடங்கள் கிடைக்கும் நேரம் மற்றும் "${exerciseGoal}" இலக்குக்கான தனிப்பயனாக்கப்பட்ட உடற்பயிற்சி திட்டம்:`;
                routine += "\n\n5 நிமிடங்கள் வார்ம் அப் (லேசான ஜாகிங், கை அசைவுகள்)";
                
                if (fitnessLevel === 'beginner') {
                    routine += "\n\n15 நிமிடங்கள் குறைந்த தீவிரம் கொண்ட கார்டியோ (நடைபயிற்சி)";
                    routine += "\n10 நிமிடங்கள் உடல் எடை பயிற்சிகள் (ஸ்க்வாட்ஸ், லஞ்சஸ், புஷ்-அப்ஸ்)";
                } else if (fitnessLevel === 'intermediate') {
                    routine += "\n\n20 நிமிடங்கள் மிதமான தீவிரம் கொண்ட கார்டியோ (வேகமான நடைபயிற்சி/ஜாகிங்)";
                    routine += "\n10 நிமிடங்கள் யோகா/நீட்சி பயிற்சிகள்";
                } else { // advanced
                    routine += "\n\n25 நிமிடங்கள் உயர் தீவிரம் கொண்ட கார்டியோ (ஓட்டம்/சைக்ளிங்)";
                    routine += "\n10 நிமிடங்கள் வலிமை பயிற்சி (டம்ப்பெல்ஸ்/உடல் எடை)";
                }
                routine += "\n\n5 நிமிடங்கள் கூல் டவுன் (மெதுவான நீட்சி)";
            } else { // English
                routine = `Here's a personalized exercise routine for your "${fitnessLevel}" fitness level, ${timeAvailable} minutes available time, and goal of "${exerciseGoal}":`;
                routine += "\n\n5 minutes Warm-up (light jogging, arm circles)";

                if (fitnessLevel === 'beginner') {
                    routine += "\n\n15 minutes Low-intensity Cardio (walking)";
                    routine += "\n10 minutes Bodyweight exercises (squats, lunges, push-ups)";
                } else if (fitnessLevel === 'intermediate') {
                    routine += "\n\n20 minutes Moderate-intensity Cardio (brisk walk/jogging)";
                    routine += "\n10 minutes Yoga/Stretching exercises";
                } else { // advanced
                    routine += "\n\n25 minutes High-intensity Cardio (running/cycling)";
                    routine += "\n10 minutes Strength training (dumbbells/bodyweight)";
                }
                routine += "\n\n5 minutes Cool-down (slow stretching)";
            }
            exerciseRoutineOutput.textContent = routine;
        });

        // --- Disease Prevention & Home Remedies (Simulated) ---
        const healthConcernInput = document.getElementById('healthConcernInput');
        const getRemedyBtn = document.getElementById('getRemedyBtn');
        const remedyOutput = document.getElementById('remedyOutput');

        const remediesData = {
            ta: {
                "ஜலதோஷம்": "சளி மற்றும் இருமலுக்கு: ஒரு கப் சூடான நீரில் தேன் மற்றும் எலுமிச்சை கலந்து குடிக்கவும். ஆவி பிடித்தல் மற்றும் இஞ்சி தேநீர் அருந்துவதும் உதவும்.",
                "செரிமானப் பிரச்சனை": "செரிமானப் பிரச்சனைக்கு: சீரகம், இஞ்சி, பெருங்காயம் போன்றவற்றை உணவில் சேர்த்துக்கொள்ளவும். போதுமான நார்ச்சத்து உள்ள உணவுகளை உண்ணவும்.",
                "தலைவலி": "தலைவலிக்கு: நெற்றியில் புதினா எண்ணெய் தடவவும் அல்லது சூடான ஒத்தடம் கொடுக்கவும். நிறைய தண்ணீர் குடிக்கவும்.",
                "காய்ச்சல்": "காய்ச்சலுக்கு: ஓய்வெடுங்கள், நிறைய திரவங்களை உட்கொள்ளுங்கள். இஞ்சி மற்றும் துளசி கொண்டு தயாரிக்கப்பட்ட கஷாயம் நிவாரணம் அளிக்கும். தொடர்ந்து காய்ச்சல் இருந்தால் மருத்துவரை அணுகவும்."
            },
            en: {
                "common cold": "For common cold and cough: Drink a warm concoction of honey and lemon in a cup of hot water. Steam inhalation and ginger tea also help.",
                "digestion issues": "For digestion problems: Include cumin, ginger, and asafoetida in your diet. Eat foods rich in fiber.",
                "headache": "For headache: Apply peppermint oil on the forehead or use a warm compress. Drink plenty of water.",
                "fever": "For fever: Rest well, consume plenty of fluids. A concoction made with ginger and tulasi leaves can provide relief. Consult a doctor if fever persists."
            }
        };

        getRemedyBtn.addEventListener('click', () => {
            const concern = healthConcernInput.value.trim().toLowerCase();
            if (!concern) {
                remedyOutput.textContent = translations[currentLanguage].remedyOutputDefault;
                return;
            }
            const remedy = remediesData[currentLanguage][concern] || (currentLanguage === 'ta' ? "இந்த உடல்நலக் கவலைக்கு எங்களால் ஒரு குறிப்பிட்ட தீர்வைக் கண்டுபிடிக்க முடியவில்லை. ஒரு மருத்துவரை அணுகவும்." : "We couldn't find a specific remedy for this health concern. Please consult a medical professional.");
            remedyOutput.textContent = remedy;
        });

        // --- Wellness Challenges (Simulated) ---
        const currentHabitInput = document.getElementById('currentHabitInput');
        const challengeGoalInput = document.getElementById('challengeGoalInput');
        const generateChallengeBtn = document.getElementById('generateChallengeBtn');
        const challengeOutput = document.getElementById('challengeOutput');

        generateChallengeBtn.addEventListener('click', () => {
            const currentHabit = currentHabitInput.value.trim();
            const challengeGoal = challengeGoalInput.value.trim();

            if (!currentHabit || !challengeGoal) {
                challengeOutput.textContent = translations[currentLanguage].challengeOutputDefault;
                return;
            }

            let challenge = "";
            if (currentLanguage === 'ta') {
                challenge = `உங்கள் தற்போதைய பழக்கமான "${currentHabit}" இலிருந்து "${challengeGoal}" என்ற இலக்கை அடைய ஒரு 7 நாள் சவால் இதோ:`;
                challenge += "\n\nநாள் 1-2: உங்கள் தற்போதைய அளவை பராமரிக்கவும்.";
                challenge += "\nநாள் 3-4: உங்கள் இலக்கை நோக்கி 25% அதிகரிக்கவும்.";
                challenge += "\nநாள் 5-6: உங்கள் இலக்கை நோக்கி 50% அதிகரிக்கவும்.";
                challenge += "\nநாள் 7: உங்கள் இலக்கை அடைய முயற்சி செய்யுங்கள்!";
                challenge += "\n\nஉந்துதலாக இருங்கள் மற்றும் ஒவ்வொரு நாளும் உங்கள் முன்னேற்றத்தைக் கண்காணிக்கவும்!";
            } else { // English
                challenge = `Here's a 7-day challenge to go from your current habit of "${currentHabit}" to your goal of "${challengeGoal}":`;
                challenge += "\n\nDay 1-2: Maintain your current level.";
                challenge += "\nDay 3-4: Increase by 25% towards your goal.";
                challenge += "\nDay 5-6: Increase by 50% towards your goal.";
                challenge += "\nDay 7: Aim to reach your full goal!";
                challenge += "\n\nStay motivated and track your progress each day!";
            }
            challengeOutput.textContent = challenge;
        });

        // --- Medication Reminder Functionality ---
        const medicationNameInput = document.getElementById('medicationNameInput');
        const medicationTimeInput = document.getElementById('medicationTimeInput');
        const medicationFrequencySelect = document.getElementById('medicationFrequencySelect');
        const addMedicationReminderBtn = document.getElementById('addMedicationReminderBtn');
        const activeRemindersList = document.getElementById('activeRemindersList');
        const noRemindersMessage = document.getElementById('noRemindersMessage');

        let medicationReminders = JSON.parse(localStorage.getItem('medicationReminders')) || [];

        function renderMedicationReminders() {
            activeRemindersList.innerHTML = '';
            if (medicationReminders.length === 0) {
                noRemindersMessage.style.display = 'block';
            } else {
                noRemindersMessage.style.display = 'none';
                medicationReminders.forEach((reminder, index) => {
                    const li = document.createElement('li');
                    li.className = 'flex justify-between items-center bg-gray-50 p-3 rounded-md mb-2';

                    let frequencyText = '';
                    if (currentLanguage === 'ta') {
                        switch (reminder.frequency) {
                            case 'daily': frequencyText = 'தினமும்'; break;
                            case 'weekly': frequencyText = 'வாராந்திர'; break;
                            case 'once': frequencyText = 'ஒரு முறை'; break;
                        }
                    } else { // English
                        switch (reminder.frequency) {
                            case 'daily': frequencyText = 'Daily'; break;
                            case 'weekly': frequencyText = 'Weekly'; break;
                            case 'once': frequencyText = 'Once'; break;
                        }
                    }

                    li.innerHTML = `
                        <span>
                            <strong>${reminder.name}</strong> at ${reminder.time} (${frequencyText})
                        </span>
                        <div>
                            <button class="text-green-600 hover:text-green-800 font-bold ml-2 mark-taken-btn" data-index="${index}" title="${currentLanguage === 'ta' ? 'எடுத்துக்கொண்டேன்' : 'Mark as Taken'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-8.92"></path>
                                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                </svg>
                            </button>
                            <button class="text-red-600 hover:text-red-800 font-bold ml-2 delete-reminder-btn" data-index="${index}" title="${currentLanguage === 'ta' ? 'நீக்கு' : 'Delete'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                            </button>
                        </div>
                    `;
                    activeRemindersList.appendChild(li);
                });

                // Add event listeners for the new buttons
                document.querySelectorAll('.mark-taken-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const index = event.currentTarget.dataset.index;
                        const reminderName = medicationReminders[index].name;
                        alert(translations[currentLanguage].medicationReminderTaken.replace('{name}', reminderName));
                        // In a real app, you might track this or remove it for 'once' reminders
                        if (medicationReminders[index].frequency === 'once') {
                            medicationReminders.splice(index, 1);
                            localStorage.setItem('medicationReminders', JSON.stringify(medicationReminders));
                            renderMedicationReminders();
                        }
                    });
                });

                document.querySelectorAll('.delete-reminder-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const index = event.currentTarget.dataset.index;
                        const reminderName = medicationReminders[index].name;
                        if (confirm(currentLanguage === 'ta' ? `நீங்கள் '${reminderName}' நினைவூட்டலை நீக்க விரும்புகிறீர்களா?` : `Are you sure you want to delete the reminder for '${reminderName}'?`)) {
                            medicationReminders.splice(index, 1);
                            localStorage.setItem('medicationReminders', JSON.stringify(medicationReminders));
                            alert(translations[currentLanguage].medicationReminderDeleted.replace('{name}', reminderName));
                            renderMedicationReminders();
                        }
                    });
                });
            }
        }

        addMedicationReminderBtn.addEventListener('click', () => {
            const name = medicationNameInput.value.trim();
            const time = medicationTimeInput.value;
            const frequency = medicationFrequencySelect.value;

            if (!name) {
                alert(translations[currentLanguage].medicationNameRequired);
                return;
            }
            if (!time) {
                alert(translations[currentLanguage].medicationTimeRequired);
                return;
            }
            if (!frequency) {
                alert(translations[currentLanguage].medicationFrequencyRequired);
                return;
            }

            const newReminder = { name, time, frequency, timestamp: new Date().toISOString() };
            medicationReminders.push(newReminder);
            localStorage.setItem('medicationReminders', JSON.stringify(medicationReminders));

            let frequencyText = '';
            if (currentLanguage === 'ta') {
                switch (frequency) {
                    case 'daily': frequencyText = 'தினமும்'; break;
                    case 'weekly': frequencyText = 'வாராந்திர'; break;
                    case 'once': frequencyText = 'ஒரு முறை'; break;
                }
            } else { // English
                switch (frequency) {
                    case 'daily': frequencyText = 'daily'; break;
                    case 'weekly': frequencyText = 'weekly'; break;
                    case 'once': frequencyText = 'once'; break;
                }
            }

            alert(translations[currentLanguage].medicationReminderSet.replace('{name}', name).replace('{time}', time).replace('{frequency}', frequencyText));

            medicationNameInput.value = '';
            medicationTimeInput.value = '';
            medicationFrequencySelect.value = '';
            renderMedicationReminders();
        });

        renderMedicationReminders(); // Initial render of medication reminders

        // --- Body Pain Mapping Functionality ---
        const bodyMapImage = document.getElementById('bodyMapImage');
        const painDotsContainer = document.getElementById('painDotsContainer');
        const recordPainBtn = document.getElementById('recordPainBtn');
        const painPointsOutput = document.getElementById('painPointsOutput');

        let painPoints = JSON.parse(localStorage.getItem('painPoints')) || [];

        function renderPainPoints() {
            painDotsContainer.innerHTML = '';
            painPointsOutput.innerHTML = `<h3 class="text-xl font-semibold text-gray-700 mb-3">${currentLanguage === 'ta' ? 'பதிவு செய்யப்பட்ட வலி புள்ளிகள்:' : 'Recorded Pain Points:'}</h3>`;

            if (painPoints.length === 0) {
                painPointsOutput.innerHTML += `<p class="text-gray-500 italic mt-2">${translations[currentLanguage].painPointsOutputDefault}</p>`;
            } else {
                const ul = document.createElement('ul');
                ul.className = 'list-disc pl-5 space-y-2';
                painPoints.forEach((point, index) => {
                    const dot = document.createElement('div');
                    dot.className = 'pain-dot';
                    dot.style.left = `${point.x}px`;
                    dot.style.top = `${point.y}px`;
                    dot.title = currentLanguage === 'ta' ? `வலி: ${point.intensity}/10 (${point.description || 'குறிப்பிடப்படாதது'}) - ${new Date(point.timestamp).toLocaleString()}` : `Pain: ${point.intensity}/10 (${point.description || 'Not specified'}) - ${new Date(point.timestamp).toLocaleString()}`;
                    
                    dot.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevent re-adding point on dot click
                        dot.classList.toggle('selected');
                    });
                    painDotsContainer.appendChild(dot);

                    const li = document.createElement('li');
                    li.innerHTML = `${currentLanguage === 'ta' ? 'வலி' : 'Pain'} ${index + 1}: ${point.intensity}/10, ${currentLanguage === 'ta' ? 'விளக்கம்' : 'Description'}: "${point.description || 'குறிப்பிடப்படாதது'}", ${currentLanguage === 'ta' ? 'தேதி' : 'Date'}: ${new Date(point.timestamp).toLocaleString(currentLanguage === 'ta' ? 'ta-IN' : 'en-US', { dateStyle: 'medium', timeStyle: 'short'})}`;
                    ul.appendChild(li);
                });
                painPointsOutput.appendChild(ul);
            }
        }

        bodyMapImage.addEventListener('click', (event) => {
            const rect = bodyMapImage.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            // Prompt user for pain intensity and description
            const intensity = prompt(currentLanguage === 'ta' ? "வலி தீவிரம் (1-10):" : "Enter pain intensity (1-10):");
            if (intensity === null || isNaN(intensity) || intensity < 1 || intensity > 10) {
                alert(currentLanguage === 'ta' ? "சரியான வலி தீவிரத்தை உள்ளிடவும் (1-10)." : "Please enter a valid pain intensity (1-10).");
                return;
            }
            const description = prompt(currentLanguage === 'ta' ? "வலி விளக்கம் (விரும்பினால்):" : "Enter pain description (optional):");

            painPoints.push({ x, y, intensity: parseInt(intensity), description: description || '', timestamp: new Date().toISOString() });
            localStorage.setItem('painPoints', JSON.stringify(painPoints));
            renderPainPoints();
        });

        recordPainBtn.addEventListener('click', () => {
            // This button primarily triggers the rendering and prompts,
            // the main action is on clicking the image itself.
            alert(currentLanguage === 'ta' ? "உடல் வரைபடத்தில் வலியுள்ள இடத்தைக் கிளிக் செய்யவும்." : "Click on the body map to mark the painful area.");
        });

        renderPainPoints(); // Initial render of pain points

        // --- First Aid & Emergency Functionality (Simulated) ---
        const emergencyInput = document.getElementById('emergencyInput');
        const getEmergencyAdviceBtn = document.getElementById('getEmergencyAdviceBtn');
        const emergencyAdviceOutput = document.getElementById('emergencyAdviceOutput');

        const emergencyData = {
            ta: {
                "வெட்டு": "ஒரு சுத்தமான துணியால் அழுத்தவும். இரத்தம் நிற்கவில்லை என்றால், மருத்துவ உதவியை நாடவும்.",
                "தீக்காயம்": "குளிர்ந்த நீரில் (பனி நீரில் அல்ல) 10-15 நிமிடங்கள் தீக்காயத்தை வைக்கவும். கொப்புளங்களை உடைக்க வேண்டாம். கடுமையான தீக்காயங்களுக்கு மருத்துவரை அணுகவும்.",
                "மயக்கம்": "நபரை தரையில் படுக்க வைத்து, கால்களை உயர்த்தவும். இறுக்கமான ஆடைகளை தளர்த்தவும். சுவாசம் இயல்பு நிலைக்கு வரும் வரை கண்காணிக்கவும். மயக்கம் தொடர்ந்தால் மருத்துவரை அணுகவும்.",
                "மூச்சுத்திணறல்": "ஹெய்ம்லிச் சூழ்ச்சியை (Heimlich maneuver) செய்யவும். உதவ முடிந்தால், 112 அல்லது உள்ளூர் அவசர எண்ணை அழைக்கவும்.",
                "இதயத் தாக்குதல்": "உடனடியாக 112 அல்லது உள்ளூர் அவசர எண்ணை அழைக்கவும். நபரை அமைதியாக உட்கார வைக்கவும். ஆஸ்பிரின் (ஒவ்வாமை இல்லையெனில்) கொடுக்கவும்.",
                "எலும்பு முறிவு": "பாதிக்கப்பட்ட பகுதியை அசைக்காமல் வைத்துக்கொள்ளவும். வீக்கத்தைக் குறைக்க ஐஸ் ஒத்தடம் கொடுக்கவும். உடனடியாக மருத்துவமனைக்கு செல்லவும்."
            },
            en: {
                "cut": "Apply direct pressure with a clean cloth. If bleeding doesn't stop, seek medical attention.",
                "burn": "Cool the burn with cool (not icy) water for 10-15 minutes. Do not break blisters. Seek medical attention for severe burns.",
                "fainting": "Lay the person down and elevate their legs. Loosen tight clothing. Monitor breathing until they recover. Seek medical help if fainting persists.",
                "choking": "Perform the Heimlich maneuver. If able, call 911 or your local emergency number.",
                "heart attack": "Immediately call 911 or your local emergency number. Keep the person calm and seated. Administer aspirin if no allergies.",
                "fracture": "Immobilize the affected area. Apply ice to reduce swelling. Seek immediate medical attention."
            }
        };

        getEmergencyAdviceBtn.addEventListener('click', () => {
            const emergency = emergencyInput.value.trim().toLowerCase();
            if (!emergency) {
                emergencyAdviceOutput.textContent = translations[currentLanguage].emergencyAdviceOutputDefault;
                return;
            }
            const advice = emergencyData[currentLanguage][emergency] || (currentLanguage === 'ta' ? "இந்த அவசர நிலைக்கு எங்களால் ஒரு குறிப்பிட்ட உதவிக்குறிப்பைக் கண்டுபிடிக்க முடியவில்லை. உடனடியாக மருத்துவ உதவியை நாடவும்." : "We couldn't find specific advice for this emergency. Please seek immediate medical attention.");
            emergencyAdviceOutput.textContent = advice;
        });

        // Ensure language updates happen for dynamic content
        document.getElementById('languageSelect').addEventListener('change', () => {
            currentLanguage = document.getElementById('languageSelect').value;
            updateContent();
            populateVoiceList(); // Update voices for TTS based on new language
            recognition.lang = currentLanguage === 'ta' ? 'ta-IN' : 'en-US'; // Update recognition language
        });
    </script>
</body>
</html>
